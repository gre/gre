<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="author" content="Ga√´tan Renaudeau"/><meta name="description" content="I would like to express here my opinion and feedback on using React and performance optimization you can do."/><meta name="keywords" content="react, vdom"/><meta name="HandheldFriendly" content="True"/><meta name="MobileOptimized" content="320"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@greweb"/><meta name="twitter:title" content="Making performant React applications"/><meta name="og:title" content="Making performant React applications"/><meta name="twitter:description" content="I would like to express here my opinion and feedback on using React and performance optimization you can do."/><meta name="twitter:creator" content="@greweb"/><meta name="og:image" content="http://greweb.me//images/2015/07/diaporama_3.jpg"/><meta name="twitter:image" content="http://greweb.me//images/2015/07/diaporama_3.jpg"/><link rel="image_src" href="http://greweb.me//images/2015/07/diaporama_3.jpg"/><title>@greweb - Making performant React applications</title><link href="http://fonts.googleapis.com/css?family=Fredericka+the+Great|Arapey|Roboto:400,700,400italic" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/styles/default.min.css"/><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/highlight.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/javascript.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/cpp.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/glsl.min.js"></script><link rel="stylesheet" href="/style/main.css"/><meta name="next-head-count" content="25"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-381dbb3c33243b4920e6.js"></script><script src="/_next/static/chunks/webpack-17597d20e291f72b2439.js" defer=""></script><script src="/_next/static/chunks/framework-bdc1b4e5e48979e16d36.js" defer=""></script><script src="/_next/static/chunks/main-4ac108dd57980e4159e9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c981e0e3ce59f13eb8d0.js" defer=""></script><script src="/_next/static/chunks/5988-738c1ea5f97353b6463e.js" defer=""></script><script src="/_next/static/chunks/2242-4500be184fa490ea9cf2.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bslug%5D-18d367ef37e4735025ef.js" defer=""></script><script src="/_next/static/ae_DOku0NQLvrO85ufv4R/_buildManifest.js" defer=""></script><script src="/_next/static/ae_DOku0NQLvrO85ufv4R/_ssgManifest.js" defer=""></script><style id="__jsx-2519965637">.block.jsx-2519965637{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.block.jsx-2519965637 .right.jsx-2519965637{padding:10px;}.block.jsx-2519965637 .social.jsx-2519965637{margin-top:10px;}.block.jsx-2519965637 .social.jsx-2519965637 a.jsx-2519965637{padding:10px;}.block.jsx-2519965637 .social.jsx-2519965637 img.jsx-2519965637{height:20px;}</style><style id="__jsx-3621368397">.container.jsx-3621368397{min-height:100vh;padding:0 0.5rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style id="__jsx-3469673304">html,body{padding:0;margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto, Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue, sans-serif;}*{box-sizing:border-box;}a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}a:hover,a:active{-webkit-text-decoration:underline;text-decoration:underline;}</style></head><body><div id="__next"><div class="jsx-3621368397 container"><div id="container"><div id="main"><div id="content"><article><header><h1><a href="/">Making performant React applications</a></h1><time class="date" dateTime="2015-08-04">2015-08-04</time><span class="tags"><a class="tag">react</a><a class="tag">vdom</a></span></header><div class="entry-content"><p><em>^ Sorry guys, you may have notice the blog post date is wrong. I won&#39;t change the URL, but thanks to how time works, this will be fixed in one month anyway :-D</em></p>
<p><a href="https://twitter.com/chantastic/status/616608931037646850">ReactEurope</a> conference
was to me incredibly <a href="https://twitter.com/chantastic/status/616670658911715328">inspiring</a> and <a href="https://twitter.com/chantastic/status/616995607043903488">promising</a>.
Yersterday got tons of news and tweets from JavaScript community.</p>
<p>One tweet and blog post by the great <a href="https://twitter.com/aerotwist">@aerotwist</a> got my attention.</p>
<blockquote class="twitter-tweet" data-cards="hidden" lang="fr"><p lang="en" dir="ltr">I often hear claims that ‚Äúthe DOM is slow!‚Äù and ‚ÄúReact is fast!‚Äù, so I decided to put that to the test:&#10;&#10;<a href="https://t.co/M1RZZiyVT2">https://t.co/M1RZZiyVT2</a>&#10;&#10;üê¢vsüêá</p>&mdash; Paul Lewis (@aerotwist) <a href="https://twitter.com/aerotwist/status/616934953679458304">3 Juillet 2015</a></blockquote>

<p>I would like to express here my opinion and feedback on using React.</p>
<p>I&#39;ve been using React for almost 2 years now, and always in performance intensive use-cases, from Games to WebGL.</p>
<a href="http://diaporama.glsl.io/" target="_blank">
<img src="/images/2015/07/diaporama_3.jpg" alt="" class="thumbnail-left" />
</a>

<p>I&#39;ve created <a href="http://glsl.io/">glsl.io</a> and I&#39;m working on <a href="https://github.com/gre/diaporama-maker">Diaporama Maker</a>.
Both applications are built with React and combined use of HTML, SVG, WebGL.</p>
<p>Diaporama Maker is probably the most ambitious piece of software I&#39;ve ever personally done.</p>
<br style="clear: left" />

<blockquote>
<p>In short, <a href="https://github.com/gre/diaporama-maker">Diaporama Maker</a> it is a WYSIWYG editor for web slideshow (mainly photo slideshows). It is a bit like iMovie with the web as first target. <a href="https://github.com/gre/diaporama-maker">The project is entirely open-sourced.</a></p>
</blockquote>
<p>Currently, I am able to render the whole application at 60 FPS and this is still unexpected and surprising to me
(press Space to run the diaporama on <a href="http://diaporama.glsl.io/">diaporama.glsl.io demo</a>).
Well, more exactly, this would not have been possible without some optimizations
that I&#39;m going to detail a bit at the end of this article.</p>
<!--more-->

<h2 id="the-point-is-productivity">The point is productivity</h2>
<p>I don&#39;t think Virtual DOM claims to be faster than doing Vanilla DOM, and that&#39;s not really the point. <strong>The point is productivity.</strong>
You can write very well optimized code in Vanilla DOM but this might require <strong>a lot of expertise</strong>
and a lot of time even for an experienced team <em>(time that should be spent focusing on making your product)</em>.</p>
<p>When it comes to adding new features and refactoring old ones, this goes worse.
Without a well constrained framework or paradigm, things does not scale far, are time consuming and introduce bugs,...
Especially in a team where multiple developers have to work with each other.</p>
<blockquote>
<p><strong>See Also:</strong> <a href="https://www.youtube.com/watch?v=D-ioDiacTm8">Why does React scale?</a> by <a href="https://twitter.com/Vjeux">@vjeux</a>.</p>
</blockquote>
<h2 id="what-matters-to-me">What matters to me</h2>
<p>There is a lot of advantages of using Virtual DOM approach before talking about React performances.</p>
<p>Of course, this always depends on what you are building, but I would claim that
<strong>there is a long way to go using React before experiencing performance issues</strong>,
and in the worse cases: <strong>you can almost always find easy solutions to optimize these performance issues</strong>.</p>
<h3 id="dx">DX</h3>
<p>React has an incredible Developer eXperience (that people seem to call DX nowadays!) that can <a href="https://twitter.com/greweb/status/617258379183005696">help you improving UX</a> and the ability to <a href="https://facebook.github.io/react/docs/perf.html">measure Performances</a> and <a href="https://facebook.github.io/react/docs/component-specs.html#updating-shouldcomponentupdate">optimize them</a> when you reach bottlenecks.</p>
<p>You can easily figure out which component is a bottleneck in the Component tree as shown in following screenshot.</p>
<blockquote>
<p><img src="/images/2015/07/diaporama-perfs.png" alt="">
With printWasted() you can see how much time React has wasted to <code>render()</code> something that didn&#39;t change and how much instances has been created. (there is also printInclusive and printExclusive)</p>
</blockquote>
<p>This is a bit equivalent of the Web Console Profiler except it emphasis on your application components which is a very relevant approach.</p>
<h3 id="react-data-flow">React data flow</h3>
<blockquote>
<p>I can&#39;t imagine re-writing Diaporama Maker in Vanilla DOM.</p>
</blockquote>
<p>In Diaporama Maker, I have a lot of cross dependencies between components,
for instance the current <code>time</code> is shared and used everywhere in the application.
As a matter of fact, dependencies grow when adding more and more features.</p>
<blockquote>
<p><img src="/images/2015/07/diaporama_configure_kenburns.gif" alt="">
usages of time in 3 independent components.</p>
</blockquote>
<p><strong>The descriptive Virtual DOM approach very simply solves this problem</strong>.
You just have to pass props in to share data between components:
there is one source of trust that climb down your component tree via &quot;props&quot;.</p>
<p><img src="/images/2015/07/diaporama-maker-time-props.jpg" alt=""></p>
<p>With Virtual DOM approach, the cost to add one new dependency to a shared data is small and <strong>does not become more complex as the application grows</strong>.</p>
<blockquote>
<p><img src="/images/2015/07/diaporama_slide_content.gif" alt="">
another more complex showcase of shared states.</p>
</blockquote>
<p>Using an Event System like you would do in standard Backbone approach tends to lead to imperative style and spaghetti codes (and when using global events, components are not really reusable).</p>
<p>Moreover, I think that <code>Views&lt;-&gt;Models</code> Event System approach, if not carefully used, tends to converge to an unmaintainable and laggy applications.</p>
<h3 id="react-is-a-component-library">React is a Component library</h3>
<p>React truly offers <strong>component as first-class citizen</strong>.
This means it allows component reusability. I&#39;ve tried alternative like virtual-dom and I don&#39;t think it emphasizes enough on this benefit.</p>
<p>There are <a href="https://twitter.com/chantastic/status/616997918155759616">important good practices</a> when using React like minimizing states and props and I&#39;m not going to expand more on this subject. Most of these best practices are not exclusive to React but come from common sense and software architecture in general.
One of the important point for performance is to <strong>choose a good granularity of your component tree</strong>.
It is generally a good idea to split up a component into pieces as small as possible
because it allows to separate concerns, minimize props and consequently optimize rendering diff.</p>
<h4 id="diaporama-maker-architecture">Diaporama Maker architecture</h4>
<p>You would be surprised to know that Diaporama Maker does not even use <strong>Flux</strong> (that might be reconsidered soon for collaborative features). I&#39;ve just taken the old &quot;callback as props&quot; approach all the way down the component tree. That easily makes all components purely modular and re-usable (no dependencies on some Stores).
I&#39;ve also taken the <a href="">inline style approach</a> without actually using any framework (this is just about props-passing <code>style</code> objects).</p>
<p>As a consequence, I&#39;ve been able to externalize a lot of tiny components that are part of my application
so I can share them across apps and also in order to people to re-use them.</p>
<p>What is important about externalizing components is also the ability to test and optimize them independently (the whole idea of modularity).</p>
<p>Here are all the standalone UI components used by Diaporama Maker:</p>
<ul>
<li><a href="https://github.com/gre/bezier-easing-editor">bezier-easing-editor</a></li>
<li><a href="https://github.com/gre/bezier-easing-picker">bezier-easing-picker</a></li>
<li><a href="https://github.com/glslio/diaporama-react">diaporama-react</a></li>
<li><a href="https://github.com/glslio/glsl-transition-vignette">glsl-transition-vignette</a></li>
<li><a href="https://github.com/glslio/glsl-transition-vignette-grid">glsl-transition-vignette-grid</a></li>
<li><a href="https://github.com/gre/glsl-uniforms-editor">glsl-uniforms-editor</a></li>
<li><a href="https://github.com/gre/kenburns-editor">kenburns-editor</a></li>
</ul>
<p>(each one have standalone demos)</p>
<h2 id="optimizing-performances">Optimizing performances</h2>
<blockquote class="twitter-tweet" lang="fr"><p lang="en" dir="ltr">I&#39;ve been working on crazy projects using React (like <a href="http://t.co/U2oETh5lhZ">http://t.co/U2oETh5lhZ</a> ). most performance issues i&#39;ve met was not because of React</p>&mdash; Ga√´tan Renaudeau (@greweb) <a href="https://twitter.com/greweb/status/617210444839809024">4 Juillet 2015</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Here are 2 examples of optimizations I had to do in Diaporama Maker that are not because of React:</p>
<ul>
<li>It is easy to write not very optimized WebGL, so I work a lot to optimize the pipeline of <a href="https://github.com/gre/diaporama">Diaporama engine</a></li>
<li>CSS transforms defined on Library images was for a time very intensive for the browser to render so I am now using server-resized &quot;thumbnails&quot; instead of the full-size images. Asking the browser to recompute the <code>transform: scale(...)</code> of 50 high resolution images can be super costy. (without this optimization, the resize of the application was running at like 2-3 FPS because the library thumbnails need to recompute their scale and crop).</li>
</ul>
<p>But what if you still have performance issue due by React? Yes this can happens.</p>
<h3 id="timeline-grid-example">Timeline Grid example</h3>
<p>In Diaporama Maker, I have a Component that generates a lot of elements (like 1300 elements for a 2 minutes slideshow) and my first naive implementation was very slow. This component is <a href="https://github.com/gre/diaporama-maker/blob/b0c6447b127785bea3c2487b0c77037418298b8c/client/ui/TimelineGrid/index.js">TimelineGrid</a> which renders the timescale in the timeline. It is implemented with SVG and a lot of <code>&lt;text&gt;</code> and <code>&lt;line&gt;</code>.</p>
<p>The performance issue was noticeable when drag and dropping items across the application. React was forced to render() and compare the whole timescale grid every time. But the timescale does not change! it just have 3 props:</p>
<pre><code class="language-xml">&lt;TimelineGrid timeScale={timeScale} width={gridWidth} height={gridHeight} /&gt;
</code></pre>
<p><strong>So it was very easy to optimize it just by using the <code>PureRenderMixin</code> to say to react that all my props are immutable.</strong>
(I could have implemented <code>shouldComponentUpdate</code> too).</p>
<p>After this step, and for this precise example, I don&#39;t think a Vanilla DOM implementation can reach better performance:</p>
<ul>
<li>when one of the grid parameter change, <strong>EVERYTHING</strong> need to be recomputed because all scales are changing.</li>
<li>React is doing even smarter thing that I would not manually do? Like reusing elements instead of destroying/creating them.</li>
</ul>
<p>There might still be ways to go more far in optimizing this example. For instance I could chunk my grid into pieces
and only render the pieces that are visible, like in an infinite scroll system <em>(I could use something like <a href="https://github.com/gre/sliding-window">sliding-window</a> for this)</em>.
That would probably be premature optimization for this example.</p>
<h2 id="wrap-up">Wrap Up</h2>
<p>To my mind, generic benchmarks always tends to be biased and does not represent use-cases reality unless you are really covering your application itself.</p>
<p>The TimelineGrid component optimization explained in this article is a very specific and well chosen example,
but it is one counter-example for such a benchmark.</p>
<p>Each application has its own needs and constraints and we can&#39;t really generalize one way to go.
Also Performance should not be the main concern to choose a technology.</p>
<p>It is easy to make Virtual DOM library benchmarks,
comparing the performance of rendering and Array diffing,
but does that covers 80% of use-cases?
Is performance really the point?
What tradeoff do you accept to make between Performance and Productivity?</p>
<p>Tell me what you think.</p>
<p>In the meantime, I think we can all continue getting applications done
and <a href="https://github.com/gaearon/react-hot-loader">developing amazing DX</a>.</p>
</div><footer><div class="jsx-2519965637 block"><img src="http://greweb.me/logo.svg" width="100" class="jsx-2519965637"/><div class="jsx-2519965637 right"><div class="jsx-2519965637 description">generative artist who uses code to make art, explores the frontier of abstract art with algorithms pushing forward to more realistic scenery. Explore physical art via &#x27;Plotting&#x27;, which consist of drawing with fountain pens on robot. I don&#x27;t do prints, I do plots: Every physical outcome is truly unique!</div><div class="jsx-2519965637 social"><a href="https://twitter.com/greweb" class="jsx-2519965637"><img alt="" src="/icons/twitter.svg" class="jsx-2519965637"/></a><a href="https://instagram.com/greweb" class="jsx-2519965637"><img alt="" src="/icons/instagram.svg" class="jsx-2519965637"/></a><a href="https://twitch.tv/greweb" class="jsx-2519965637"><img alt="" src="/icons/twitch.svg" class="jsx-2519965637"/></a><a href="https://github.com/gre" class="jsx-2519965637"><img alt="" src="/icons/github.svg" class="jsx-2519965637"/></a><a href="https://opensea.io/greweb?tab=created" class="jsx-2519965637"><img alt="" src="/icons/eth.svg" class="jsx-2519965637"/></a><a href="https://objkt.com/profile/tz1cgQAQfECg5bPASYTMyJ9QJQjSUi8rfL67" class="jsx-2519965637"><img alt="" src="/icons/tz.svg" class="jsx-2519965637"/></a><a href="https://fxhash.xyz/u/greweb" class="jsx-2519965637"><img alt="" src="/icons/tz.svg" class="jsx-2519965637"/></a><a href="https://greweb.itch.io" class="jsx-2519965637"><img alt="" src="/icons/iconmonstr-gamepad-3.svg" class="jsx-2519965637"/></a></div></div></div></footer></article></div></div></div><script>hljs.highlightAll();</script></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"2015-08-04-making-performant-react-applications","year":"2015","month":"08","day":"04","slug":"making-performant-react-applications","content":"\u003cp\u003e\u003cem\u003e^ Sorry guys, you may have notice the blog post date is wrong. I won\u0026#39;t change the URL, but thanks to how time works, this will be fixed in one month anyway :-D\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://twitter.com/chantastic/status/616608931037646850\"\u003eReactEurope\u003c/a\u003e conference\nwas to me incredibly \u003ca href=\"https://twitter.com/chantastic/status/616670658911715328\"\u003einspiring\u003c/a\u003e and \u003ca href=\"https://twitter.com/chantastic/status/616995607043903488\"\u003epromising\u003c/a\u003e.\nYersterday got tons of news and tweets from JavaScript community.\u003c/p\u003e\n\u003cp\u003eOne tweet and blog post by the great \u003ca href=\"https://twitter.com/aerotwist\"\u003e@aerotwist\u003c/a\u003e got my attention.\u003c/p\u003e\n\u003cblockquote class=\"twitter-tweet\" data-cards=\"hidden\" lang=\"fr\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eI often hear claims that ‚Äúthe DOM is slow!‚Äù and ‚ÄúReact is fast!‚Äù, so I decided to put that to the test:\u0026#10;\u0026#10;\u003ca href=\"https://t.co/M1RZZiyVT2\"\u003ehttps://t.co/M1RZZiyVT2\u003c/a\u003e\u0026#10;\u0026#10;üê¢vsüêá\u003c/p\u003e\u0026mdash; Paul Lewis (@aerotwist) \u003ca href=\"https://twitter.com/aerotwist/status/616934953679458304\"\u003e3 Juillet 2015\u003c/a\u003e\u003c/blockquote\u003e\n\n\u003cp\u003eI would like to express here my opinion and feedback on using React.\u003c/p\u003e\n\u003cp\u003eI\u0026#39;ve been using React for almost 2 years now, and always in performance intensive use-cases, from Games to WebGL.\u003c/p\u003e\n\u003ca href=\"http://diaporama.glsl.io/\" target=\"_blank\"\u003e\n\u003cimg src=\"/images/2015/07/diaporama_3.jpg\" alt=\"\" class=\"thumbnail-left\" /\u003e\n\u003c/a\u003e\n\n\u003cp\u003eI\u0026#39;ve created \u003ca href=\"http://glsl.io/\"\u003eglsl.io\u003c/a\u003e and I\u0026#39;m working on \u003ca href=\"https://github.com/gre/diaporama-maker\"\u003eDiaporama Maker\u003c/a\u003e.\nBoth applications are built with React and combined use of HTML, SVG, WebGL.\u003c/p\u003e\n\u003cp\u003eDiaporama Maker is probably the most ambitious piece of software I\u0026#39;ve ever personally done.\u003c/p\u003e\n\u003cbr style=\"clear: left\" /\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eIn short, \u003ca href=\"https://github.com/gre/diaporama-maker\"\u003eDiaporama Maker\u003c/a\u003e it is a WYSIWYG editor for web slideshow (mainly photo slideshows). It is a bit like iMovie with the web as first target. \u003ca href=\"https://github.com/gre/diaporama-maker\"\u003eThe project is entirely open-sourced.\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eCurrently, I am able to render the whole application at 60 FPS and this is still unexpected and surprising to me\n(press Space to run the diaporama on \u003ca href=\"http://diaporama.glsl.io/\"\u003ediaporama.glsl.io demo\u003c/a\u003e).\nWell, more exactly, this would not have been possible without some optimizations\nthat I\u0026#39;m going to detail a bit at the end of this article.\u003c/p\u003e\n\u003c!--more--\u003e\n\n\u003ch2 id=\"the-point-is-productivity\"\u003eThe point is productivity\u003c/h2\u003e\n\u003cp\u003eI don\u0026#39;t think Virtual DOM claims to be faster than doing Vanilla DOM, and that\u0026#39;s not really the point. \u003cstrong\u003eThe point is productivity.\u003c/strong\u003e\nYou can write very well optimized code in Vanilla DOM but this might require \u003cstrong\u003ea lot of expertise\u003c/strong\u003e\nand a lot of time even for an experienced team \u003cem\u003e(time that should be spent focusing on making your product)\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eWhen it comes to adding new features and refactoring old ones, this goes worse.\nWithout a well constrained framework or paradigm, things does not scale far, are time consuming and introduce bugs,...\nEspecially in a team where multiple developers have to work with each other.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eSee Also:\u003c/strong\u003e \u003ca href=\"https://www.youtube.com/watch?v=D-ioDiacTm8\"\u003eWhy does React scale?\u003c/a\u003e by \u003ca href=\"https://twitter.com/Vjeux\"\u003e@vjeux\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"what-matters-to-me\"\u003eWhat matters to me\u003c/h2\u003e\n\u003cp\u003eThere is a lot of advantages of using Virtual DOM approach before talking about React performances.\u003c/p\u003e\n\u003cp\u003eOf course, this always depends on what you are building, but I would claim that\n\u003cstrong\u003ethere is a long way to go using React before experiencing performance issues\u003c/strong\u003e,\nand in the worse cases: \u003cstrong\u003eyou can almost always find easy solutions to optimize these performance issues\u003c/strong\u003e.\u003c/p\u003e\n\u003ch3 id=\"dx\"\u003eDX\u003c/h3\u003e\n\u003cp\u003eReact has an incredible Developer eXperience (that people seem to call DX nowadays!) that can \u003ca href=\"https://twitter.com/greweb/status/617258379183005696\"\u003ehelp you improving UX\u003c/a\u003e and the ability to \u003ca href=\"https://facebook.github.io/react/docs/perf.html\"\u003emeasure Performances\u003c/a\u003e and \u003ca href=\"https://facebook.github.io/react/docs/component-specs.html#updating-shouldcomponentupdate\"\u003eoptimize them\u003c/a\u003e when you reach bottlenecks.\u003c/p\u003e\n\u003cp\u003eYou can easily figure out which component is a bottleneck in the Component tree as shown in following screenshot.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cimg src=\"/images/2015/07/diaporama-perfs.png\" alt=\"\"\u003e\nWith printWasted() you can see how much time React has wasted to \u003ccode\u003erender()\u003c/code\u003e something that didn\u0026#39;t change and how much instances has been created. (there is also printInclusive and printExclusive)\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThis is a bit equivalent of the Web Console Profiler except it emphasis on your application components which is a very relevant approach.\u003c/p\u003e\n\u003ch3 id=\"react-data-flow\"\u003eReact data flow\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eI can\u0026#39;t imagine re-writing Diaporama Maker in Vanilla DOM.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIn Diaporama Maker, I have a lot of cross dependencies between components,\nfor instance the current \u003ccode\u003etime\u003c/code\u003e is shared and used everywhere in the application.\nAs a matter of fact, dependencies grow when adding more and more features.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cimg src=\"/images/2015/07/diaporama_configure_kenburns.gif\" alt=\"\"\u003e\nusages of time in 3 independent components.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003eThe descriptive Virtual DOM approach very simply solves this problem\u003c/strong\u003e.\nYou just have to pass props in to share data between components:\nthere is one source of trust that climb down your component tree via \u0026quot;props\u0026quot;.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2015/07/diaporama-maker-time-props.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eWith Virtual DOM approach, the cost to add one new dependency to a shared data is small and \u003cstrong\u003edoes not become more complex as the application grows\u003c/strong\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cimg src=\"/images/2015/07/diaporama_slide_content.gif\" alt=\"\"\u003e\nanother more complex showcase of shared states.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eUsing an Event System like you would do in standard Backbone approach tends to lead to imperative style and spaghetti codes (and when using global events, components are not really reusable).\u003c/p\u003e\n\u003cp\u003eMoreover, I think that \u003ccode\u003eViews\u0026lt;-\u0026gt;Models\u003c/code\u003e Event System approach, if not carefully used, tends to converge to an unmaintainable and laggy applications.\u003c/p\u003e\n\u003ch3 id=\"react-is-a-component-library\"\u003eReact is a Component library\u003c/h3\u003e\n\u003cp\u003eReact truly offers \u003cstrong\u003ecomponent as first-class citizen\u003c/strong\u003e.\nThis means it allows component reusability. I\u0026#39;ve tried alternative like virtual-dom and I don\u0026#39;t think it emphasizes enough on this benefit.\u003c/p\u003e\n\u003cp\u003eThere are \u003ca href=\"https://twitter.com/chantastic/status/616997918155759616\"\u003eimportant good practices\u003c/a\u003e when using React like minimizing states and props and I\u0026#39;m not going to expand more on this subject. Most of these best practices are not exclusive to React but come from common sense and software architecture in general.\nOne of the important point for performance is to \u003cstrong\u003echoose a good granularity of your component tree\u003c/strong\u003e.\nIt is generally a good idea to split up a component into pieces as small as possible\nbecause it allows to separate concerns, minimize props and consequently optimize rendering diff.\u003c/p\u003e\n\u003ch4 id=\"diaporama-maker-architecture\"\u003eDiaporama Maker architecture\u003c/h4\u003e\n\u003cp\u003eYou would be surprised to know that Diaporama Maker does not even use \u003cstrong\u003eFlux\u003c/strong\u003e (that might be reconsidered soon for collaborative features). I\u0026#39;ve just taken the old \u0026quot;callback as props\u0026quot; approach all the way down the component tree. That easily makes all components purely modular and re-usable (no dependencies on some Stores).\nI\u0026#39;ve also taken the \u003ca href=\"\"\u003einline style approach\u003c/a\u003e without actually using any framework (this is just about props-passing \u003ccode\u003estyle\u003c/code\u003e objects).\u003c/p\u003e\n\u003cp\u003eAs a consequence, I\u0026#39;ve been able to externalize a lot of tiny components that are part of my application\nso I can share them across apps and also in order to people to re-use them.\u003c/p\u003e\n\u003cp\u003eWhat is important about externalizing components is also the ability to test and optimize them independently (the whole idea of modularity).\u003c/p\u003e\n\u003cp\u003eHere are all the standalone UI components used by Diaporama Maker:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/gre/bezier-easing-editor\"\u003ebezier-easing-editor\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/gre/bezier-easing-picker\"\u003ebezier-easing-picker\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/glslio/diaporama-react\"\u003ediaporama-react\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/glslio/glsl-transition-vignette\"\u003eglsl-transition-vignette\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/glslio/glsl-transition-vignette-grid\"\u003eglsl-transition-vignette-grid\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/gre/glsl-uniforms-editor\"\u003eglsl-uniforms-editor\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/gre/kenburns-editor\"\u003ekenburns-editor\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e(each one have standalone demos)\u003c/p\u003e\n\u003ch2 id=\"optimizing-performances\"\u003eOptimizing performances\u003c/h2\u003e\n\u003cblockquote class=\"twitter-tweet\" lang=\"fr\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eI\u0026#39;ve been working on crazy projects using React (like \u003ca href=\"http://t.co/U2oETh5lhZ\"\u003ehttp://t.co/U2oETh5lhZ\u003c/a\u003e ). most performance issues i\u0026#39;ve met was not because of React\u003c/p\u003e\u0026mdash; Ga√´tan Renaudeau (@greweb) \u003ca href=\"https://twitter.com/greweb/status/617210444839809024\"\u003e4 Juillet 2015\u003c/a\u003e\u003c/blockquote\u003e\n\u003cscript async src=\"//platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\n\u003cp\u003eHere are 2 examples of optimizations I had to do in Diaporama Maker that are not because of React:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIt is easy to write not very optimized WebGL, so I work a lot to optimize the pipeline of \u003ca href=\"https://github.com/gre/diaporama\"\u003eDiaporama engine\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eCSS transforms defined on Library images was for a time very intensive for the browser to render so I am now using server-resized \u0026quot;thumbnails\u0026quot; instead of the full-size images. Asking the browser to recompute the \u003ccode\u003etransform: scale(...)\u003c/code\u003e of 50 high resolution images can be super costy. (without this optimization, the resize of the application was running at like 2-3 FPS because the library thumbnails need to recompute their scale and crop).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBut what if you still have performance issue due by React? Yes this can happens.\u003c/p\u003e\n\u003ch3 id=\"timeline-grid-example\"\u003eTimeline Grid example\u003c/h3\u003e\n\u003cp\u003eIn Diaporama Maker, I have a Component that generates a lot of elements (like 1300 elements for a 2 minutes slideshow) and my first naive implementation was very slow. This component is \u003ca href=\"https://github.com/gre/diaporama-maker/blob/b0c6447b127785bea3c2487b0c77037418298b8c/client/ui/TimelineGrid/index.js\"\u003eTimelineGrid\u003c/a\u003e which renders the timescale in the timeline. It is implemented with SVG and a lot of \u003ccode\u003e\u0026lt;text\u0026gt;\u003c/code\u003e and \u003ccode\u003e\u0026lt;line\u0026gt;\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThe performance issue was noticeable when drag and dropping items across the application. React was forced to render() and compare the whole timescale grid every time. But the timescale does not change! it just have 3 props:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-xml\"\u003e\u0026lt;TimelineGrid timeScale={timeScale} width={gridWidth} height={gridHeight} /\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eSo it was very easy to optimize it just by using the \u003ccode\u003ePureRenderMixin\u003c/code\u003e to say to react that all my props are immutable.\u003c/strong\u003e\n(I could have implemented \u003ccode\u003eshouldComponentUpdate\u003c/code\u003e too).\u003c/p\u003e\n\u003cp\u003eAfter this step, and for this precise example, I don\u0026#39;t think a Vanilla DOM implementation can reach better performance:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ewhen one of the grid parameter change, \u003cstrong\u003eEVERYTHING\u003c/strong\u003e need to be recomputed because all scales are changing.\u003c/li\u003e\n\u003cli\u003eReact is doing even smarter thing that I would not manually do? Like reusing elements instead of destroying/creating them.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThere might still be ways to go more far in optimizing this example. For instance I could chunk my grid into pieces\nand only render the pieces that are visible, like in an infinite scroll system \u003cem\u003e(I could use something like \u003ca href=\"https://github.com/gre/sliding-window\"\u003esliding-window\u003c/a\u003e for this)\u003c/em\u003e.\nThat would probably be premature optimization for this example.\u003c/p\u003e\n\u003ch2 id=\"wrap-up\"\u003eWrap Up\u003c/h2\u003e\n\u003cp\u003eTo my mind, generic benchmarks always tends to be biased and does not represent use-cases reality unless you are really covering your application itself.\u003c/p\u003e\n\u003cp\u003eThe TimelineGrid component optimization explained in this article is a very specific and well chosen example,\nbut it is one counter-example for such a benchmark.\u003c/p\u003e\n\u003cp\u003eEach application has its own needs and constraints and we can\u0026#39;t really generalize one way to go.\nAlso Performance should not be the main concern to choose a technology.\u003c/p\u003e\n\u003cp\u003eIt is easy to make Virtual DOM library benchmarks,\ncomparing the performance of rendering and Array diffing,\nbut does that covers 80% of use-cases?\nIs performance really the point?\nWhat tradeoff do you accept to make between Performance and Productivity?\u003c/p\u003e\n\u003cp\u003eTell me what you think.\u003c/p\u003e\n\u003cp\u003eIn the meantime, I think we can all continue getting applications done\nand \u003ca href=\"https://github.com/gaearon/react-hot-loader\"\u003edeveloping amazing DX\u003c/a\u003e.\u003c/p\u003e\n","data":{"title":"Making performant React applications","description":"I would like to express here my opinion and feedback on using React and performance optimization you can do.","thumbnail":"/images/2015/07/diaporama_3.jpg","author":"Gaetan","layout":"post","tags":["react","vdom"]}},"__N_SSG":true},"page":"/[year]/[month]/[slug]","query":{"year":"2015","month":"08","slug":"making-performant-react-applications"},"buildId":"ae_DOku0NQLvrO85ufv4R","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
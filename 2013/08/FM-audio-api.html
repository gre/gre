<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="author" content="GaÃ«tan Renaudeau"/><meta name="description" content=""/><meta name="keywords" content="fm, audio"/><meta name="HandheldFriendly" content="True"/><meta name="MobileOptimized" content="320"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@greweb"/><meta name="twitter:title" content="Frequency Modulation (FM) with Web Audio API"/><meta name="og:title" content="Frequency Modulation (FM) with Web Audio API"/><meta name="twitter:creator" content="@greweb"/><title>@greweb - Frequency Modulation (FM) with Web Audio API</title><link href="http://fonts.googleapis.com/css?family=Fredericka+the+Great|Arapey|Roboto:400,700,400italic" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/styles/default.min.css"/><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/highlight.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/javascript.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/cpp.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/glsl.min.js"></script><link rel="stylesheet" href="/style/main.css"/><meta name="next-head-count" content="21"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-381dbb3c33243b4920e6.js"></script><script src="/_next/static/chunks/webpack-17597d20e291f72b2439.js" defer=""></script><script src="/_next/static/chunks/framework-bdc1b4e5e48979e16d36.js" defer=""></script><script src="/_next/static/chunks/main-4ac108dd57980e4159e9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c981e0e3ce59f13eb8d0.js" defer=""></script><script src="/_next/static/chunks/5988-738c1ea5f97353b6463e.js" defer=""></script><script src="/_next/static/chunks/2242-e809902ac2d7a524d02b.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bslug%5D-18d367ef37e4735025ef.js" defer=""></script><script src="/_next/static/-362UiaOdeoa5MIW5u6HL/_buildManifest.js" defer=""></script><script src="/_next/static/-362UiaOdeoa5MIW5u6HL/_ssgManifest.js" defer=""></script><style id="__jsx-2519965637">.block.jsx-2519965637{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.block.jsx-2519965637 .right.jsx-2519965637{padding:10px;}.block.jsx-2519965637 .social.jsx-2519965637{margin-top:10px;}.block.jsx-2519965637 .social.jsx-2519965637 a.jsx-2519965637{padding:10px;}.block.jsx-2519965637 .social.jsx-2519965637 img.jsx-2519965637{height:20px;}</style><style id="__jsx-3621368397">.container.jsx-3621368397{min-height:100vh;padding:0 0.5rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style id="__jsx-3469673304">html,body{padding:0;margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto, Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue, sans-serif;}*{box-sizing:border-box;}a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}a:hover,a:active{-webkit-text-decoration:underline;text-decoration:underline;}</style></head><body><div id="__next"><div class="jsx-3621368397 container"><div id="container"><div id="main"><div id="content"><article><header><h1><a href="/">Frequency Modulation (FM) with Web Audio API</a></h1><time class="date" dateTime="2013-08-21">2013-08-21</time><span class="tags"><a class="tag">fm</a><a class="tag">audio</a></span></header><div class="entry-content"><p>The main principle of <a href="http://en.wikipedia.org/wiki/Frequency_modulation_synthesis">Frequency Modulation (FM)</a> is to <strong>pipe an Oscillator (the Modulator)
into the frequency of another Oscillator (the Carrier)</strong>.</p>
<p>This article will explain to you how FM Synthesis works with <strong>interactive demos</strong>.
In the meantime, all demos are implemented with the brand new <strong>Web Audio API</strong>,
so feel free to hack the code for your own purpose.</p>
<p>This article will also introduce some Audio concepts like <strong>LFO</strong>, <strong>Envelope</strong> and <strong>Finetuning</strong>.</p>
<p>I&#39;ve recently implemented a very first FM in <a href="/2013/07/zound-live/">ZOUND live</a> - <em>a HTML5 collaborative audio tracker</em>,
giving much more powerful Synthesizers (see in the following video).</p>
<iframe width="640" height="480" src="//www.youtube.com/embed/El4JvaDWQUM" frameborder="0" allowfullscreen></iframe>
[*(here is the implementation of that FM)*][zoundfm]


<!--more-->

<h2 id="dive-into-frequency-modulation-synthesis">Dive into Frequency Modulation Synthesis</h2>
<p>As mentioned previously, FM is about <strong>piping an Oscillator (the <u>Modulator</u>) into the frequency of another Oscillator (the <u>Carrier</u>)</strong>.</p>
<p>The Modulator oscillation only affects the oscillation frequency of the Carrier but is not directly an audio signal.</p>
<p><img src="/images/2013/08/fm_principle.png" alt=""></p>
<p>The result of that modulation differs depending on each oscillator <strong>frequency</strong> and <strong>amplitude</strong>:</p>
<p><a href="http://en.wikipedia.org/wiki/File:Frequencymodulationdemo-td.png"><img src="/images/2013/08/Frequencymodulationdemo-td.png" alt=""></a></p>
<p><em><strong>N.B.</strong></em> <em>Our interactive demos in this article will always play a sound and visualize it (waveform / spectrum analyzer).
You will have different kind of controls depending on each specific aspect I want to illustrate.</em></p>
<p><em>The demos should work on Chrome. <strong>However if you get an AudioContext failure, please reload the page</strong> (you may not be able to start them all in one row).</em></p>
<h3 id="lfo">LFO</h3>
<p><strong>Low-Frequency Oscillation (LFO)</strong> is very used in electronic music for making rythmic audio effects.</p>
<p>LFO is simply a specific subset of a oscillator in a sense that <strong>its oscilation frequency is under
the human audible range (20 Hz)</strong> and is then not generally used as an audio signal but as an effect controller.</p>
<p>For instance the frequency / the amplitude of an oscillator, or in the following example the frequency of the cut-off filter:</p>
<p><audio src="http://upload.wikimedia.org/wikipedia/commons/e/e4/Lfo-cutoff-frequency-wobble-bass.ogg" controls></audio></p>
<p>Now, as a first demo,
let&#39;s see what happens if our <strong>FM Modulator is an LFO</strong>,
<em>(i.e. if that Modulator is in low frequency range)</em>.</p>
<iframe width="100%" height="310" src="http://fiddle.jshell.net/FvnJx/58/show/light/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
<a href="http://jsfiddle.net/FvnJx/58/" target="_blank" style="display: block; text-align: right">Open on jsfiddle</a>

<p>Observe in the Carrier graphs how <strong>the waveform is regulary compressed and decompressed</strong>. If you increase the Modulator frequency, it will speed up this effect. A real FM is about speeding up that effect up to the audible range...</p>
<p><em><strong>N.B.</strong></em> <em>With <em>Web Audio API</em> (more generally with any modular synthesizers) we can easily control any module parameter with an LFO:</em></p>
<pre><code class="language-javascript">lfo.connect(carrier.frequency);
</code></pre>
<h4 id="modulator-in-audible-range">Modulator in audible range</h4>
<p>Now, if we increase the frequency to the hearing range, here is what happens:
<em>(in that example you can also change the Carrier frequency)</em></p>
<iframe width="100%" height="310" src="http://fiddle.jshell.net/x4CWR/36/show/light/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
<a href="http://jsfiddle.net/x4CWR/36/" target="_blank" style="display: block; text-align: right">Open on jsfiddle</a>


<p>It&#39;s as if that <strong>once the Modulator reaches that audible barrier, it kind of becomes a second audible synthesizer</strong>,
even if it only modulate the frequency of the actual synthesizer.
However, it&#39;s completely different than playing the two synthesizers directly into the output,
again the modulator influence the frequency of the carrier and is not directly piped into the output audio signal.</p>
<p><em>There is especially cool sound produced when the Modulator frequency is closed to the Carrier frequency. For more infos, see the <u>Finetuning</u> section.</em></p>
<h3 id="frequency-ratios-harmonic-or-dissonant-sounds">Frequency ratios: harmonic or dissonant sounds</h3>
<p>One thing you may also have notice in the previous example is that most of the generated sounds was quite dissonant, non harmonic.</p>
<p>Now, if we add more restrictions and only <strong>snap the possible modulator frequencies</strong>
to a <strong>multiple of the carrier frequency</strong>, here is what happens:</p>
<iframe width="100%" height="310" src="http://fiddle.jshell.net/Euezv/17/show/light/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
<a href="http://jsfiddle.net/Euezv/17/" target="_blank" style="display: block; text-align: right">Open on jsfiddle</a>

<p>This harmonic result is due a simple fact in music: <strong>Mutiplying a note frequency by 2 is equivalent to Increasing that note by one octave,</strong> meaning the note has the same tone but is one-octave higher. (and vice versa for the division). <em>BTW, you may have noticed that fact by repetition of peaks in the previous example Spectrum Visualization.</em></p>
<p>Now we can release some restrictions by also allowing frequencies multiple of <code>carrier frequency / 4</code>, which means allowing to increase/decrease by an <strong>octave</strong>, a <strong>semi-octave</strong> or a <strong>quarter-of-octave</strong>.</p>
<iframe width="100%" height="310" src="http://fiddle.jshell.net/DFSwN/13/show/light/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
<a href="http://jsfiddle.net/DFSwN/13/" target="_blank" style="display: block; text-align: right">Open on jsfiddle</a>


<p><em>Eventually you could even allow more freedom using multiple of <code>carrier freq / 12</code>, because an octave is equally divided by 12 in the <a href="http://en.wikipedia.org/wiki/Chromatic_scale">Chromatic scale</a>.</em></p>
<h3 id="mixing-the-power-of-the-modulator-effect">Mixing the power of the Modulator effect</h3>
<p>A very interesting part of the job is also to change the <strong>amplitude of the modulator</strong>. So far, we used a full amplitude modulating the carrier frequency from 0 to 2-times its original frequency which produces a quite rough sound.</p>
<p>Try to change the modulator amplitude on the following demo:</p>
<iframe width="100%" height="310" src="http://fiddle.jshell.net/DAT5S/12/show/light/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
<a href="http://jsfiddle.net/DAT5S/12/" target="_blank" style="display: block; text-align: right">Open on jsfiddle</a>

<p>Technically, we can easily control that range to any by changing the gain of the Modulator with a <code>GainNode</code> which is just a tool to scale the amplitude of a signal.</p>
<h3 id="envelope">Envelope</h3>
<p>Now, we need to add an <strong>Envelope</strong> for automating that amplitude change you just experiment with.</p>
<p>An envelope in electronic music will generally look like this:</p>
<p><a href="http://en.wikipedia.org/wiki/File:ADSR_parameter.svg"><img src="/images/2013/08/500px-ADSR_parameter.svg.png" alt=""></a></p>
<p>An Envelope corresponds to a <strong>note lifespan</strong>.
It is the minimum required for making our Synth.</p>
<p>We will generally <strong>automate that amplitude through time for each note triggered</strong>.</p>
<p>Here is a demo.
Play, try to hold and release a note (using the Play button or SPACE), and observe how the Spectrum Analyzer is moving:</p>
<iframe width="100%" height="400" src="http://fiddle.jshell.net/tyEKr/32/show/light/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
<a href="http://jsfiddle.net/tyEKr/32/" target="_blank" style="display: block; text-align: right">Open on jsfiddle</a>

<p><strong>Two different envelopes</strong> has been used: one for the <strong>Modulator</strong> and one for the <strong>Carrier</strong> which produce <strong>different sound effects in a note lifespan</strong>.</p>
<p><em>We won&#39;t make an interactive demo for changing these envelope parameters,
but you can try them in the ZOUND project (or see again the video).</em></p>
<h3 id="finetuning">Finetuning</h3>
<p>Another interesting effect occurs <strong>when the frequency of the Modulator is very close to the frequency of the Carrier</strong>.
In the following example, we have set both oscillators to the same frequency but we expose a &quot;detune&quot; parameter which allows to change a bit the frequency of the Modulator.</p>
<iframe width="100%" height="400" src="http://fiddle.jshell.net/X95S6/10/show/light/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
<a href="http://jsfiddle.net/X95S6/10/" target="_blank" style="display: block; text-align: right">Open on jsfiddle</a>

<p>You can slightly notice that a sound is regulary looping like if it was an LFO effect. You can also visualize it on the graph.</p>
<p>This effect corresponds to the <strong><a href="http://tinyurl.com/nzkus8">phase</a> change between both oscillators</strong>: it regulary change from <strong>&quot;in-phase&quot;</strong> state (where it have exactly the same sine waveform at the same time) to a desynchronize <strong>&quot;out-of-phase&quot;</strong> (because of the small detune), and then slightly go to the next &quot;in-phase&quot; step. More the frequencies are close, more it takes time to oscillate from phase to phase.</p>
<p>This effect is especially awesome when you start mixing multiple synths together and finetune a bit each one so they don&#39;t sound exactly on the same frequency.</p>
<h3 id="modulating-the-modulator">Modulating the Modulator</h3>
<p>There is so much more possibilites to play with,
for instance, the previously introduced Envelope could be mixed
with an LFO to change the Modulator effect in a rythm,
but now let&#39;s see how we can...</p>
<p><strong>...modulate the modulator!</strong></p>
<p>Eventually we can make a stack of modulators and use different kind of waveforms
for more powerful effects:</p>
<p><img src="/images/2013/08/fm_multiple.png" alt=""></p>
<blockquote>
<p>Be careful when playing with stack of modulators, it is quite easy to have saturated or noisy sounds.</p>
</blockquote>
<p>As an example, I made this experiment which randomly takes different frequencies and amplitude for a stack of 5 modulators:</p>
<p><a href="http://jsfiddle.net/s2MMR/45/"><strong>-&gt; http://jsfiddle.net/s2MMR/45/ &lt;-</strong></a></p>
<p>Careful! this experiment is a bit crazy! but it shows how different patterns can be when playing with FM.</p>
<!-- TODO soon...
## Last demo, polished FMs playing a famous song...

As a last demo example, and in a more readable & simple code, here is a polished example of FM.
-->

<hr>
<p>Also, <strong>If you are interested by ZOUND live, <a href="http://github.com/gre/zound-live/">fork it on Github</a>.</strong></p>
</div><footer><div class="jsx-2519965637 block"><img src="http://greweb.me/logo.svg" width="100" class="jsx-2519965637"/><div class="jsx-2519965637 right"><div class="jsx-2519965637 description">As a generative plotter artist, I use code to create art (creative coding), draw with fountain pens on robots (plotting), and explore the boundaries of abstract art using algorithms in pursuit of increasingly realistic imagery. I do not produce prints; instead, I create unique &#x27;plots&#x27; - physical works of art that are truly one-of-a-kind.</div><div class="jsx-2519965637 social"><a href="https://twitter.com/greweb" class="jsx-2519965637"><img alt="" src="/icons/twitter.svg" class="jsx-2519965637"/></a><a href="https://instagram.com/greweb" class="jsx-2519965637"><img alt="" src="/icons/instagram.svg" class="jsx-2519965637"/></a><a href="https://twitch.tv/greweb" class="jsx-2519965637"><img alt="" src="/icons/twitch.svg" class="jsx-2519965637"/></a><a href="https://github.com/gre" class="jsx-2519965637"><img alt="" src="/icons/github.svg" class="jsx-2519965637"/></a><a href="https://opensea.io/greweb?tab=created" class="jsx-2519965637"><img alt="" src="/icons/eth.svg" class="jsx-2519965637"/></a><a href="https://fxhash.xyz/u/greweb" class="jsx-2519965637"><img alt="" src="/icons/tz.svg" class="jsx-2519965637"/></a><a href="https://greweb.itch.io" class="jsx-2519965637"><img alt="" src="/icons/iconmonstr-gamepad-3.svg" class="jsx-2519965637"/></a></div></div></div></footer></article></div></div></div><script>hljs.highlightAll();</script></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"2013-08-21-FM-audio-api","year":"2013","month":"08","day":"21","slug":"FM-audio-api","content":"\u003cp\u003eThe main principle of \u003ca href=\"http://en.wikipedia.org/wiki/Frequency_modulation_synthesis\"\u003eFrequency Modulation (FM)\u003c/a\u003e is to \u003cstrong\u003epipe an Oscillator (the Modulator)\ninto the frequency of another Oscillator (the Carrier)\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eThis article will explain to you how FM Synthesis works with \u003cstrong\u003einteractive demos\u003c/strong\u003e.\nIn the meantime, all demos are implemented with the brand new \u003cstrong\u003eWeb Audio API\u003c/strong\u003e,\nso feel free to hack the code for your own purpose.\u003c/p\u003e\n\u003cp\u003eThis article will also introduce some Audio concepts like \u003cstrong\u003eLFO\u003c/strong\u003e, \u003cstrong\u003eEnvelope\u003c/strong\u003e and \u003cstrong\u003eFinetuning\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eI\u0026#39;ve recently implemented a very first FM in \u003ca href=\"/2013/07/zound-live/\"\u003eZOUND live\u003c/a\u003e - \u003cem\u003ea HTML5 collaborative audio tracker\u003c/em\u003e,\ngiving much more powerful Synthesizers (see in the following video).\u003c/p\u003e\n\u003ciframe width=\"640\" height=\"480\" src=\"//www.youtube.com/embed/El4JvaDWQUM\" frameborder=\"0\" allowfullscreen\u003e\u003c/iframe\u003e\n[*(here is the implementation of that FM)*][zoundfm]\n\n\n\u003c!--more--\u003e\n\n\u003ch2 id=\"dive-into-frequency-modulation-synthesis\"\u003eDive into Frequency Modulation Synthesis\u003c/h2\u003e\n\u003cp\u003eAs mentioned previously, FM is about \u003cstrong\u003epiping an Oscillator (the \u003cu\u003eModulator\u003c/u\u003e) into the frequency of another Oscillator (the \u003cu\u003eCarrier\u003c/u\u003e)\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eThe Modulator oscillation only affects the oscillation frequency of the Carrier but is not directly an audio signal.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2013/08/fm_principle.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eThe result of that modulation differs depending on each oscillator \u003cstrong\u003efrequency\u003c/strong\u003e and \u003cstrong\u003eamplitude\u003c/strong\u003e:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://en.wikipedia.org/wiki/File:Frequencymodulationdemo-td.png\"\u003e\u003cimg src=\"/images/2013/08/Frequencymodulationdemo-td.png\" alt=\"\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eN.B.\u003c/strong\u003e\u003c/em\u003e \u003cem\u003eOur interactive demos in this article will always play a sound and visualize it (waveform / spectrum analyzer).\nYou will have different kind of controls depending on each specific aspect I want to illustrate.\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eThe demos should work on Chrome. \u003cstrong\u003eHowever if you get an AudioContext failure, please reload the page\u003c/strong\u003e (you may not be able to start them all in one row).\u003c/em\u003e\u003c/p\u003e\n\u003ch3 id=\"lfo\"\u003eLFO\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eLow-Frequency Oscillation (LFO)\u003c/strong\u003e is very used in electronic music for making rythmic audio effects.\u003c/p\u003e\n\u003cp\u003eLFO is simply a specific subset of a oscillator in a sense that \u003cstrong\u003eits oscilation frequency is under\nthe human audible range (20 Hz)\u003c/strong\u003e and is then not generally used as an audio signal but as an effect controller.\u003c/p\u003e\n\u003cp\u003eFor instance the frequency / the amplitude of an oscillator, or in the following example the frequency of the cut-off filter:\u003c/p\u003e\n\u003cp\u003e\u003caudio src=\"http://upload.wikimedia.org/wikipedia/commons/e/e4/Lfo-cutoff-frequency-wobble-bass.ogg\" controls\u003e\u003c/audio\u003e\u003c/p\u003e\n\u003cp\u003eNow, as a first demo,\nlet\u0026#39;s see what happens if our \u003cstrong\u003eFM Modulator is an LFO\u003c/strong\u003e,\n\u003cem\u003e(i.e. if that Modulator is in low frequency range)\u003c/em\u003e.\u003c/p\u003e\n\u003ciframe width=\"100%\" height=\"310\" src=\"http://fiddle.jshell.net/FvnJx/58/show/light/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"\u003e\u003c/iframe\u003e\n\u003ca href=\"http://jsfiddle.net/FvnJx/58/\" target=\"_blank\" style=\"display: block; text-align: right\"\u003eOpen on jsfiddle\u003c/a\u003e\n\n\u003cp\u003eObserve in the Carrier graphs how \u003cstrong\u003ethe waveform is regulary compressed and decompressed\u003c/strong\u003e. If you increase the Modulator frequency, it will speed up this effect. A real FM is about speeding up that effect up to the audible range...\u003c/p\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eN.B.\u003c/strong\u003e\u003c/em\u003e \u003cem\u003eWith \u003cem\u003eWeb Audio API\u003c/em\u003e (more generally with any modular synthesizers) we can easily control any module parameter with an LFO:\u003c/em\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003elfo.connect(carrier.frequency);\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"modulator-in-audible-range\"\u003eModulator in audible range\u003c/h4\u003e\n\u003cp\u003eNow, if we increase the frequency to the hearing range, here is what happens:\n\u003cem\u003e(in that example you can also change the Carrier frequency)\u003c/em\u003e\u003c/p\u003e\n\u003ciframe width=\"100%\" height=\"310\" src=\"http://fiddle.jshell.net/x4CWR/36/show/light/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"\u003e\u003c/iframe\u003e\n\u003ca href=\"http://jsfiddle.net/x4CWR/36/\" target=\"_blank\" style=\"display: block; text-align: right\"\u003eOpen on jsfiddle\u003c/a\u003e\n\n\n\u003cp\u003eIt\u0026#39;s as if that \u003cstrong\u003eonce the Modulator reaches that audible barrier, it kind of becomes a second audible synthesizer\u003c/strong\u003e,\neven if it only modulate the frequency of the actual synthesizer.\nHowever, it\u0026#39;s completely different than playing the two synthesizers directly into the output,\nagain the modulator influence the frequency of the carrier and is not directly piped into the output audio signal.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eThere is especially cool sound produced when the Modulator frequency is closed to the Carrier frequency. For more infos, see the \u003cu\u003eFinetuning\u003c/u\u003e section.\u003c/em\u003e\u003c/p\u003e\n\u003ch3 id=\"frequency-ratios-harmonic-or-dissonant-sounds\"\u003eFrequency ratios: harmonic or dissonant sounds\u003c/h3\u003e\n\u003cp\u003eOne thing you may also have notice in the previous example is that most of the generated sounds was quite dissonant, non harmonic.\u003c/p\u003e\n\u003cp\u003eNow, if we add more restrictions and only \u003cstrong\u003esnap the possible modulator frequencies\u003c/strong\u003e\nto a \u003cstrong\u003emultiple of the carrier frequency\u003c/strong\u003e, here is what happens:\u003c/p\u003e\n\u003ciframe width=\"100%\" height=\"310\" src=\"http://fiddle.jshell.net/Euezv/17/show/light/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"\u003e\u003c/iframe\u003e\n\u003ca href=\"http://jsfiddle.net/Euezv/17/\" target=\"_blank\" style=\"display: block; text-align: right\"\u003eOpen on jsfiddle\u003c/a\u003e\n\n\u003cp\u003eThis harmonic result is due a simple fact in music: \u003cstrong\u003eMutiplying a note frequency by 2 is equivalent to Increasing that note by one octave,\u003c/strong\u003e meaning the note has the same tone but is one-octave higher. (and vice versa for the division). \u003cem\u003eBTW, you may have noticed that fact by repetition of peaks in the previous example Spectrum Visualization.\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eNow we can release some restrictions by also allowing frequencies multiple of \u003ccode\u003ecarrier frequency / 4\u003c/code\u003e, which means allowing to increase/decrease by an \u003cstrong\u003eoctave\u003c/strong\u003e, a \u003cstrong\u003esemi-octave\u003c/strong\u003e or a \u003cstrong\u003equarter-of-octave\u003c/strong\u003e.\u003c/p\u003e\n\u003ciframe width=\"100%\" height=\"310\" src=\"http://fiddle.jshell.net/DFSwN/13/show/light/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"\u003e\u003c/iframe\u003e\n\u003ca href=\"http://jsfiddle.net/DFSwN/13/\" target=\"_blank\" style=\"display: block; text-align: right\"\u003eOpen on jsfiddle\u003c/a\u003e\n\n\n\u003cp\u003e\u003cem\u003eEventually you could even allow more freedom using multiple of \u003ccode\u003ecarrier freq / 12\u003c/code\u003e, because an octave is equally divided by 12 in the \u003ca href=\"http://en.wikipedia.org/wiki/Chromatic_scale\"\u003eChromatic scale\u003c/a\u003e.\u003c/em\u003e\u003c/p\u003e\n\u003ch3 id=\"mixing-the-power-of-the-modulator-effect\"\u003eMixing the power of the Modulator effect\u003c/h3\u003e\n\u003cp\u003eA very interesting part of the job is also to change the \u003cstrong\u003eamplitude of the modulator\u003c/strong\u003e. So far, we used a full amplitude modulating the carrier frequency from 0 to 2-times its original frequency which produces a quite rough sound.\u003c/p\u003e\n\u003cp\u003eTry to change the modulator amplitude on the following demo:\u003c/p\u003e\n\u003ciframe width=\"100%\" height=\"310\" src=\"http://fiddle.jshell.net/DAT5S/12/show/light/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"\u003e\u003c/iframe\u003e\n\u003ca href=\"http://jsfiddle.net/DAT5S/12/\" target=\"_blank\" style=\"display: block; text-align: right\"\u003eOpen on jsfiddle\u003c/a\u003e\n\n\u003cp\u003eTechnically, we can easily control that range to any by changing the gain of the Modulator with a \u003ccode\u003eGainNode\u003c/code\u003e which is just a tool to scale the amplitude of a signal.\u003c/p\u003e\n\u003ch3 id=\"envelope\"\u003eEnvelope\u003c/h3\u003e\n\u003cp\u003eNow, we need to add an \u003cstrong\u003eEnvelope\u003c/strong\u003e for automating that amplitude change you just experiment with.\u003c/p\u003e\n\u003cp\u003eAn envelope in electronic music will generally look like this:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://en.wikipedia.org/wiki/File:ADSR_parameter.svg\"\u003e\u003cimg src=\"/images/2013/08/500px-ADSR_parameter.svg.png\" alt=\"\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eAn Envelope corresponds to a \u003cstrong\u003enote lifespan\u003c/strong\u003e.\nIt is the minimum required for making our Synth.\u003c/p\u003e\n\u003cp\u003eWe will generally \u003cstrong\u003eautomate that amplitude through time for each note triggered\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eHere is a demo.\nPlay, try to hold and release a note (using the Play button or SPACE), and observe how the Spectrum Analyzer is moving:\u003c/p\u003e\n\u003ciframe width=\"100%\" height=\"400\" src=\"http://fiddle.jshell.net/tyEKr/32/show/light/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"\u003e\u003c/iframe\u003e\n\u003ca href=\"http://jsfiddle.net/tyEKr/32/\" target=\"_blank\" style=\"display: block; text-align: right\"\u003eOpen on jsfiddle\u003c/a\u003e\n\n\u003cp\u003e\u003cstrong\u003eTwo different envelopes\u003c/strong\u003e has been used: one for the \u003cstrong\u003eModulator\u003c/strong\u003e and one for the \u003cstrong\u003eCarrier\u003c/strong\u003e which produce \u003cstrong\u003edifferent sound effects in a note lifespan\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eWe won\u0026#39;t make an interactive demo for changing these envelope parameters,\nbut you can try them in the ZOUND project (or see again the video).\u003c/em\u003e\u003c/p\u003e\n\u003ch3 id=\"finetuning\"\u003eFinetuning\u003c/h3\u003e\n\u003cp\u003eAnother interesting effect occurs \u003cstrong\u003ewhen the frequency of the Modulator is very close to the frequency of the Carrier\u003c/strong\u003e.\nIn the following example, we have set both oscillators to the same frequency but we expose a \u0026quot;detune\u0026quot; parameter which allows to change a bit the frequency of the Modulator.\u003c/p\u003e\n\u003ciframe width=\"100%\" height=\"400\" src=\"http://fiddle.jshell.net/X95S6/10/show/light/\" allowfullscreen=\"allowfullscreen\" frameborder=\"0\"\u003e\u003c/iframe\u003e\n\u003ca href=\"http://jsfiddle.net/X95S6/10/\" target=\"_blank\" style=\"display: block; text-align: right\"\u003eOpen on jsfiddle\u003c/a\u003e\n\n\u003cp\u003eYou can slightly notice that a sound is regulary looping like if it was an LFO effect. You can also visualize it on the graph.\u003c/p\u003e\n\u003cp\u003eThis effect corresponds to the \u003cstrong\u003e\u003ca href=\"http://tinyurl.com/nzkus8\"\u003ephase\u003c/a\u003e change between both oscillators\u003c/strong\u003e: it regulary change from \u003cstrong\u003e\u0026quot;in-phase\u0026quot;\u003c/strong\u003e state (where it have exactly the same sine waveform at the same time) to a desynchronize \u003cstrong\u003e\u0026quot;out-of-phase\u0026quot;\u003c/strong\u003e (because of the small detune), and then slightly go to the next \u0026quot;in-phase\u0026quot; step. More the frequencies are close, more it takes time to oscillate from phase to phase.\u003c/p\u003e\n\u003cp\u003eThis effect is especially awesome when you start mixing multiple synths together and finetune a bit each one so they don\u0026#39;t sound exactly on the same frequency.\u003c/p\u003e\n\u003ch3 id=\"modulating-the-modulator\"\u003eModulating the Modulator\u003c/h3\u003e\n\u003cp\u003eThere is so much more possibilites to play with,\nfor instance, the previously introduced Envelope could be mixed\nwith an LFO to change the Modulator effect in a rythm,\nbut now let\u0026#39;s see how we can...\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e...modulate the modulator!\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eEventually we can make a stack of modulators and use different kind of waveforms\nfor more powerful effects:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2013/08/fm_multiple.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eBe careful when playing with stack of modulators, it is quite easy to have saturated or noisy sounds.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eAs an example, I made this experiment which randomly takes different frequencies and amplitude for a stack of 5 modulators:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://jsfiddle.net/s2MMR/45/\"\u003e\u003cstrong\u003e-\u0026gt; http://jsfiddle.net/s2MMR/45/ \u0026lt;-\u003c/strong\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eCareful! this experiment is a bit crazy! but it shows how different patterns can be when playing with FM.\u003c/p\u003e\n\u003c!-- TODO soon...\n## Last demo, polished FMs playing a famous song...\n\nAs a last demo example, and in a more readable \u0026 simple code, here is a polished example of FM.\n--\u003e\n\n\u003chr\u003e\n\u003cp\u003eAlso, \u003cstrong\u003eIf you are interested by ZOUND live, \u003ca href=\"http://github.com/gre/zound-live/\"\u003efork it on Github\u003c/a\u003e.\u003c/strong\u003e\u003c/p\u003e\n","data":{"title":"Frequency Modulation (FM) with Web Audio API","description":"","author":"Gaetan","layout":"post","tags":["fm","audio"]}},"__N_SSG":true},"page":"/[year]/[month]/[slug]","query":{"year":"2013","month":"08","slug":"FM-audio-api"},"buildId":"-362UiaOdeoa5MIW5u6HL","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
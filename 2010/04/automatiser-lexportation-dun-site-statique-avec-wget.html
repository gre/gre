<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="author" content="Gaëtan Renaudeau"/><meta name="description"/><meta name="keywords" content="playframework"/><meta name="HandheldFriendly" content="True"/><meta name="MobileOptimized" content="320"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@greweb"/><meta name="twitter:title" content="Automatiser l&#x27;exportation d&#x27;un site statique avec wget"/><meta name="og:title" content="Automatiser l&#x27;exportation d&#x27;un site statique avec wget"/><meta name="twitter:creator" content="@greweb"/><title>@greweb - Automatiser l&#x27;exportation d&#x27;un site statique avec wget</title><link href="http://fonts.googleapis.com/css?family=Fredericka+the+Great|Arapey|Roboto:400,700,400italic" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/styles/default.min.css"/><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/highlight.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/javascript.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/cpp.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/glsl.min.js"></script><link rel="stylesheet" href="/style/main.css"/><meta name="next-head-count" content="21"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-c914a1e31212c00c738a.js" defer=""></script><script src="/_next/static/chunks/framework-bdc1b4e5e48979e16d36.js" defer=""></script><script src="/_next/static/chunks/main-3b0c517193ca5150f81f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c981e0e3ce59f13eb8d0.js" defer=""></script><script src="/_next/static/chunks/5988-738c1ea5f97353b6463e.js" defer=""></script><script src="/_next/static/chunks/2242-eb3b6e81e9125c246631.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bslug%5D-476d7e87469cc8a40c59.js" defer=""></script><script src="/_next/static/R1qR5uW0xDogRObwWLoMw/_buildManifest.js" defer=""></script><script src="/_next/static/R1qR5uW0xDogRObwWLoMw/_ssgManifest.js" defer=""></script><style id="__jsx-2519965637">.block.jsx-2519965637{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.block.jsx-2519965637 .right.jsx-2519965637{padding:10px;}.block.jsx-2519965637 .social.jsx-2519965637{margin-top:10px;}.block.jsx-2519965637 .social.jsx-2519965637 a.jsx-2519965637{padding:10px;}.block.jsx-2519965637 .social.jsx-2519965637 img.jsx-2519965637{height:20px;}</style><style id="__jsx-3621368397">.container.jsx-3621368397{min-height:100vh;padding:0 0.5rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style id="__jsx-3469673304">html,body{padding:0;margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto, Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue, sans-serif;}*{box-sizing:border-box;}a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}a:hover,a:active{-webkit-text-decoration:underline;text-decoration:underline;}</style></head><body><div id="__next"><div class="jsx-3621368397 container"><div id="container"><div id="main"><div id="content"><article><header><h1><a href="/">Automatiser l&#x27;exportation d&#x27;un site statique avec wget</a></h1><time class="date" dateTime="2010-04-04">2010-04-04</time><span class="tags"><a class="tag">playframework</a></span></header><div class="entry-content"><p>Il est préférable d’<strong>utiliser un framework web</strong> même si l’on veut réaliser un <strong>site vitrine simple (statique)</strong>, car l’on bénéficie des avantages du framework notamment de l’héritage (entre autre) des templates, de l’internationalisation, de la configuration des <em>routes</em>, du <em>SASS</em>, etc.</p>
<p>De plus, cela permet de rendre la maintenabilité moins longue et couteuse.</p>
<p>Néanmoins, son hébergeur ne permet pas toujours de faire tourner son site avec le framework utilisé (par exemple <em>ruby on rails</em> ou <em>play! framework</em>).</p>
<p>Pour remédier à ce problème, il suffit d’<strong>exporter son site statique en simples pages HTML</strong>.</p>
<p>Cet article est donc destiné aux particuliers ne voulant pas investir dans un serveur dédié, fans de framework avancés qui ne sont pas supportés par les offres d’entrée de gamme des hébergeurs (qui n’offrent généralement que le support du php).</p>
<p><strong>D’ailleurs, pour ce type de site, pourquoi utiliser un framework MVC si l’on utilise que des vues ?</strong></p>
<h2 id="la-démarche">La démarche</h2>
<h3 id="le-site-web">Le site web</h3>
<p><strong>Réalisez le site</strong> avec votre framework préféré et faites en sorte que la page principale (<strong>/</strong>) <strong>permette l’accès à toutes les pages du site</strong> par des liens (pas forcément directs).</p>
<h3 id="exportation">Exportation</h3>
<p>Avec <strong>wget</strong> récupérez votre site à la ligne de commande :</p>
<pre><code class="language-bash">wget -r -k -np &quot;http://localhost:9000/&quot;
</code></pre>
<p>A l’instar d’un moteur de recherche, c’est cette commande qui va s’occuper de <strong>retracer toutes les pages web de votre site</strong>, mais aussi toutes ses ressources (images, css, js, ..). En plus de cela, elle va <strong>préserver le fonctionnement des liens</strong> entre pages.</p>
<p>Adaptez <em><a href="http://localhost:9000/">http://localhost:9000/</a></em> à l’url de votre site.</p>
<p>Cela va créer le dossier <em>localhost:9000</em>, il ne vous restera plus qu’à l’envoyer sur votre serveur http.</p>
<h2 id="internationalisation">Internationalisation</h2>
<p>Voici une solution pour exporter son internationalisation.</p>
<p>Elle consiste à rediriger l’utilisateur, depuis la page principale, sur la bonne page internationalisée en fonction de sa langue (indiquée par le navigateur), tout <strong>en gardant les fichiers publics en commun</strong> (css, images).</p>
<h3 id="préparer-ses-routes">Préparer ses routes</h3>
<p>préparez les uri pour qu’elles soient de la forme <strong>/{lang}/*/</strong> avec <strong>lang</strong> désignant la langue désirée.</p>
<h4 id="exemples-de-routes">Exemples de routes</h4>
<pre><code>/en/
/en/about/
/fr/
/fr/about/
</code></pre>
<h3 id="ajouter-des-liens-dans-les-templates-pour-changer-de-langue">Ajouter des liens dans les templates pour changer de langue</h3>
<p>Cette action est délicate car, comme précisé auparavant, <strong>wget</strong> essaye de retracer tous les liens entre pages.</p>
<p>Ainsi, si l’on crée des liens entre les différentes langues, <strong>wget</strong> créera un dossier <em>public</em> pour chaque langue internationalisée.</p>
<p>Pour contourner ce problème et ainsi factoriser les fichiers communs, <strong>une solution est de créer les liens à posteriori</strong>.</p>
<h4 id="solution-exemple-avec-play-framework">Solution exemple avec play framework</h4>
<pre><code>&lt;p&gt;
#{if lang!=&#39;en&#39;}
  &lt;a ADD_HERE_ENGLISH_LINK_ATTRIBUTES&gt;english version&lt;/a&gt;
#{/if}
#{if lang!=&#39;fr&#39;}
  &lt;a ADD_HERE_FRENCH_LINK_ATTRIBUTES&gt;french version&lt;/a&gt;
#{/if}
&lt;/p&gt;
</code></pre>
<pre><code class="language-bash">#!/bin/bash
# script bash
wget -r -k -np &quot;http://localhost:9000/&quot;
sed -i s/ADD_HERE_ENGLISH_LINK_ATTRIBUTES/href=\&quot;\\/en\\/\&quot;/g $(find . -name &quot;*.html&quot;)
sed -i s/ADD_HERE_FRENCH_LINK_ATTRIBUTES/href=\&quot;\\/fr\\/\&quot;/g $(find . -name &quot;*.html&quot;)
</code></pre>
<h3 id="préparer-une-page-de-redirection">Préparer une page de redirection</h3>
<p><strong>Placez à posteriori un script de redirection à l’url /</strong> pour rediriger vers la page adéquat.</p>
<h4 id="par-exemple-un-script-php">Par exemple un script php</h4>
<pre><code class="language-php">&lt;?php
$langs = array();

if (isset($_SERVER[&#39;HTTP_ACCEPT_LANGUAGE&#39;])) {
    preg_match_all(&#39;/([a-z]{1,8}(-[a-z]{1,8})?)\s*(;\s*q\s*=\s*(1|0\.[0-9]+))?/i&#39;, $_SERVER[&#39;HTTP_ACCEPT_LANGUAGE&#39;], $lang_parse);
    if (count($lang_parse[1])) {
        $langs = array_combine($lang_parse[1], $lang_parse[4]);
        foreach ($langs as $lang =&gt; $val) {
            if ($val === &#39;&#39;) $langs[$lang] = 1;
        }
        arsort($langs, SORT_NUMERIC);
    }
}

foreach ($langs as $lang =&gt; $val) {
  if (strpos($lang, &#39;fr&#39;) === 0) {
    header(&#39;Location: fr&#39;);
    die();
  }
  else if (strpos($lang, &#39;en&#39;) === 0) {
    header(&#39;Location: en&#39;);
    die();
  }
}
header(&#39;Location: en&#39;);
?&gt;
</code></pre>
</div><footer><div class="jsx-2519965637 block"><img src="http://greweb.me/logo.svg" width="100" class="jsx-2519965637"/><div class="jsx-2519965637 right"><div class="jsx-2519965637 description">As a generative plotter artist, I use code to generate art (creative coding) and physically create it with pen plotters, which is itself a generative process – each physical plot is a unique variant. I love dualities, like digital vs analog physical, abstract vs figurative, orthogonal vs polar, photo vs noise,...</div><div class="jsx-2519965637 social"><a href="https://discord.gg/DQBajxzn" class="jsx-2519965637"><img alt="" src="/icons/discord.svg" class="jsx-2519965637"/></a><a href="https://twitter.com/greweb" class="jsx-2519965637"><img alt="" src="/icons/twitter.svg" class="jsx-2519965637"/></a><a href="https://instagram.com/greweb" class="jsx-2519965637"><img alt="" src="/icons/instagram.svg" class="jsx-2519965637"/></a><a href="https://twitch.tv/greweb" class="jsx-2519965637"><img alt="" src="/icons/twitch.svg" class="jsx-2519965637"/></a><a href="https://github.com/gre" class="jsx-2519965637"><img alt="" src="/icons/github.svg" class="jsx-2519965637"/></a><a href="https://youtube.com/@greweb" class="jsx-2519965637"><img alt="" src="/icons/youtube.svg" class="jsx-2519965637"/></a><a href="https://opensea.io/greweb?tab=created" class="jsx-2519965637"><img alt="" src="/icons/eth.svg" class="jsx-2519965637"/></a><a href="https://fxhash.xyz/u/greweb" class="jsx-2519965637"><img alt="" src="/icons/tz.svg" class="jsx-2519965637"/></a><a href="https://greweb.itch.io" class="jsx-2519965637"><img alt="" src="/icons/iconmonstr-gamepad-3.svg" class="jsx-2519965637"/></a></div></div></div></footer></article></div></div></div><script>hljs.highlightAll();</script></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"2010-04-04-automatiser-lexportation-dun-site-statique-avec-wget","year":"2010","month":"04","day":"04","slug":"automatiser-lexportation-dun-site-statique-avec-wget","content":"\u003cp\u003eIl est préférable d’\u003cstrong\u003eutiliser un framework web\u003c/strong\u003e même si l’on veut réaliser un \u003cstrong\u003esite vitrine simple (statique)\u003c/strong\u003e, car l’on bénéficie des avantages du framework notamment de l’héritage (entre autre) des templates, de l’internationalisation, de la configuration des \u003cem\u003eroutes\u003c/em\u003e, du \u003cem\u003eSASS\u003c/em\u003e, etc.\u003c/p\u003e\n\u003cp\u003eDe plus, cela permet de rendre la maintenabilité moins longue et couteuse.\u003c/p\u003e\n\u003cp\u003eNéanmoins, son hébergeur ne permet pas toujours de faire tourner son site avec le framework utilisé (par exemple \u003cem\u003eruby on rails\u003c/em\u003e ou \u003cem\u003eplay! framework\u003c/em\u003e).\u003c/p\u003e\n\u003cp\u003ePour remédier à ce problème, il suffit d’\u003cstrong\u003eexporter son site statique en simples pages HTML\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eCet article est donc destiné aux particuliers ne voulant pas investir dans un serveur dédié, fans de framework avancés qui ne sont pas supportés par les offres d’entrée de gamme des hébergeurs (qui n’offrent généralement que le support du php).\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eD’ailleurs, pour ce type de site, pourquoi utiliser un framework MVC si l’on utilise que des vues ?\u003c/strong\u003e\u003c/p\u003e\n\u003ch2 id=\"la-démarche\"\u003eLa démarche\u003c/h2\u003e\n\u003ch3 id=\"le-site-web\"\u003eLe site web\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eRéalisez le site\u003c/strong\u003e avec votre framework préféré et faites en sorte que la page principale (\u003cstrong\u003e/\u003c/strong\u003e) \u003cstrong\u003epermette l’accès à toutes les pages du site\u003c/strong\u003e par des liens (pas forcément directs).\u003c/p\u003e\n\u003ch3 id=\"exportation\"\u003eExportation\u003c/h3\u003e\n\u003cp\u003eAvec \u003cstrong\u003ewget\u003c/strong\u003e récupérez votre site à la ligne de commande :\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003ewget -r -k -np \u0026quot;http://localhost:9000/\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eA l’instar d’un moteur de recherche, c’est cette commande qui va s’occuper de \u003cstrong\u003eretracer toutes les pages web de votre site\u003c/strong\u003e, mais aussi toutes ses ressources (images, css, js, ..). En plus de cela, elle va \u003cstrong\u003epréserver le fonctionnement des liens\u003c/strong\u003e entre pages.\u003c/p\u003e\n\u003cp\u003eAdaptez \u003cem\u003e\u003ca href=\"http://localhost:9000/\"\u003ehttp://localhost:9000/\u003c/a\u003e\u003c/em\u003e à l’url de votre site.\u003c/p\u003e\n\u003cp\u003eCela va créer le dossier \u003cem\u003elocalhost:9000\u003c/em\u003e, il ne vous restera plus qu’à l’envoyer sur votre serveur http.\u003c/p\u003e\n\u003ch2 id=\"internationalisation\"\u003eInternationalisation\u003c/h2\u003e\n\u003cp\u003eVoici une solution pour exporter son internationalisation.\u003c/p\u003e\n\u003cp\u003eElle consiste à rediriger l’utilisateur, depuis la page principale, sur la bonne page internationalisée en fonction de sa langue (indiquée par le navigateur), tout \u003cstrong\u003een gardant les fichiers publics en commun\u003c/strong\u003e (css, images).\u003c/p\u003e\n\u003ch3 id=\"préparer-ses-routes\"\u003ePréparer ses routes\u003c/h3\u003e\n\u003cp\u003epréparez les uri pour qu’elles soient de la forme \u003cstrong\u003e/{lang}/*/\u003c/strong\u003e avec \u003cstrong\u003elang\u003c/strong\u003e désignant la langue désirée.\u003c/p\u003e\n\u003ch4 id=\"exemples-de-routes\"\u003eExemples de routes\u003c/h4\u003e\n\u003cpre\u003e\u003ccode\u003e/en/\n/en/about/\n/fr/\n/fr/about/\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"ajouter-des-liens-dans-les-templates-pour-changer-de-langue\"\u003eAjouter des liens dans les templates pour changer de langue\u003c/h3\u003e\n\u003cp\u003eCette action est délicate car, comme précisé auparavant, \u003cstrong\u003ewget\u003c/strong\u003e essaye de retracer tous les liens entre pages.\u003c/p\u003e\n\u003cp\u003eAinsi, si l’on crée des liens entre les différentes langues, \u003cstrong\u003ewget\u003c/strong\u003e créera un dossier \u003cem\u003epublic\u003c/em\u003e pour chaque langue internationalisée.\u003c/p\u003e\n\u003cp\u003ePour contourner ce problème et ainsi factoriser les fichiers communs, \u003cstrong\u003eune solution est de créer les liens à posteriori\u003c/strong\u003e.\u003c/p\u003e\n\u003ch4 id=\"solution-exemple-avec-play-framework\"\u003eSolution exemple avec play framework\u003c/h4\u003e\n\u003cpre\u003e\u003ccode\u003e\u0026lt;p\u0026gt;\n#{if lang!=\u0026#39;en\u0026#39;}\n  \u0026lt;a ADD_HERE_ENGLISH_LINK_ATTRIBUTES\u0026gt;english version\u0026lt;/a\u0026gt;\n#{/if}\n#{if lang!=\u0026#39;fr\u0026#39;}\n  \u0026lt;a ADD_HERE_FRENCH_LINK_ATTRIBUTES\u0026gt;french version\u0026lt;/a\u0026gt;\n#{/if}\n\u0026lt;/p\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e#!/bin/bash\n# script bash\nwget -r -k -np \u0026quot;http://localhost:9000/\u0026quot;\nsed -i s/ADD_HERE_ENGLISH_LINK_ATTRIBUTES/href=\\\u0026quot;\\\\/en\\\\/\\\u0026quot;/g $(find . -name \u0026quot;*.html\u0026quot;)\nsed -i s/ADD_HERE_FRENCH_LINK_ATTRIBUTES/href=\\\u0026quot;\\\\/fr\\\\/\\\u0026quot;/g $(find . -name \u0026quot;*.html\u0026quot;)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"préparer-une-page-de-redirection\"\u003ePréparer une page de redirection\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003ePlacez à posteriori un script de redirection à l’url /\u003c/strong\u003e pour rediriger vers la page adéquat.\u003c/p\u003e\n\u003ch4 id=\"par-exemple-un-script-php\"\u003ePar exemple un script php\u003c/h4\u003e\n\u003cpre\u003e\u003ccode class=\"language-php\"\u003e\u0026lt;?php\n$langs = array();\n\nif (isset($_SERVER[\u0026#39;HTTP_ACCEPT_LANGUAGE\u0026#39;])) {\n    preg_match_all(\u0026#39;/([a-z]{1,8}(-[a-z]{1,8})?)\\s*(;\\s*q\\s*=\\s*(1|0\\.[0-9]+))?/i\u0026#39;, $_SERVER[\u0026#39;HTTP_ACCEPT_LANGUAGE\u0026#39;], $lang_parse);\n    if (count($lang_parse[1])) {\n        $langs = array_combine($lang_parse[1], $lang_parse[4]);\n        foreach ($langs as $lang =\u0026gt; $val) {\n            if ($val === \u0026#39;\u0026#39;) $langs[$lang] = 1;\n        }\n        arsort($langs, SORT_NUMERIC);\n    }\n}\n\nforeach ($langs as $lang =\u0026gt; $val) {\n  if (strpos($lang, \u0026#39;fr\u0026#39;) === 0) {\n    header(\u0026#39;Location: fr\u0026#39;);\n    die();\n  }\n  else if (strpos($lang, \u0026#39;en\u0026#39;) === 0) {\n    header(\u0026#39;Location: en\u0026#39;);\n    die();\n  }\n}\nheader(\u0026#39;Location: en\u0026#39;);\n?\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n","data":{"title":"Automatiser l'exportation d'un site statique avec wget","author":"Gaetan","layout":"post","permalink":"/2010/04/automatiser-lexportation-dun-site-statique-avec-wget/","tags":["playframework"]}},"__N_SSG":true},"page":"/[year]/[month]/[slug]","query":{"year":"2010","month":"04","slug":"automatiser-lexportation-dun-site-statique-avec-wget"},"buildId":"R1qR5uW0xDogRObwWLoMw","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
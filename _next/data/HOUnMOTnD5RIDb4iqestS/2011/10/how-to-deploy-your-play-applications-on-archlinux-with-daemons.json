{"pageProps":{"id":"2011-10-15-how-to-deploy-your-play-applications-on-archlinux-with-daemons","year":"2011","month":"10","day":"15","slug":"how-to-deploy-your-play-applications-on-archlinux-with-daemons","content":"<p>This video shows how to run different instances of <a href=\"http://playframework.org\">Play framework</a> server in the most Linux friendly way: using daemons. Example with ArchLinux, using yaourt, the <a href=\"http://aur.archlinux.org/packages.php?ID=45541\">playframework AUR package</a> and <a href=\"http://nginx.org\">nginx</a>.</p>\n<iframe src=\"http://player.vimeo.com/video/30603225?title=0&amp;byline=0&amp;portrait=0\" width=\"400\" height=\"300\" frameborder=\"0\" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>\n\n<h1 id=\"some-links\">Some links</h1>\n<ul>\n<li>  <a href=\"http://playframework.org\">Play framework website</a></li>\n<li>  <a href=\"https://wiki.archlinux.org/index.php/Play_framework\">Play framework Archlinux documentation</a></li>\n<li>  <a href=\"http://aur.archlinux.org/packages.php?ID=45541\">Play framework AUR package</a></li>\n</ul>\n<!--more-->\n\n<h1 id=\"abstract-summary\">Abstract summary</h1>\n<h2 id=\"introduction\">Introduction</h2>\n<p>Existing Platform as a Service: <a href=\"http://playapps.net\">Playapps.net</a>, <a href=\"http://heroku.com\">Heroku.com</a>.</p>\n<p>Our needs are quite different: you sometimes need to have your own server on your own infrastructure and not depending on third party web services.</p>\n<p>Let’s see how to deploy some play applications from scratch with ArchLinux.</p>\n<h2 id=\"requirement\">Requirement</h2>\n<p><a href=\"http://archlinux.org\">Install ArchLinux on your server</a></p>\n<p><a href=\"http://archlinux.fr/yaourt-en\">Install yaourt</a></p>\n<h2 id=\"installation\">Installation</h2>\n<pre><code class=\"language-bash\">yaourt -S playframework\n</code></pre>\n<h2 id=\"creating-2-play-framework-applications\">Creating 2 play framework applications</h2>\n<pre><code class=\"language-bash\">mkdir sites &amp;&amp; cd sites  \nplay new app1  \nplay new app2 # editing app/views/\n</code></pre>\n<h2 id=\"configuring-daemons\">Configuring daemons</h2>\n<pre><code class=\"language-bash\">cd /etc/rc.d  \nln -s skeleton_playapp app1  \nln -s skeleton_playapp app2  \ncd /etc/conf.d  \ncp playapp_sample app1  \ncp playapp_sample app2  \nvim app1 # configure variables  \nvim app2 # configure variables\n```bash\n\nFor app1 :\n\n```bash\nPLAY_APP=/home/gre/sites/app1  \nPLAY_USER=gre  \nPLAY_ARGS=&quot;--%prod --http.port=9001&quot; \n</code></pre>\n<p>For app2 :</p>\n<pre><code class=\"language-bash\">PLAY_APP=/home/gre/sites/app2  \nPLAY_USER=gre  \nPLAY_ARGS=&quot;--%prod --http.port=9002&quot; \n</code></pre>\n<h2 id=\"starting-daemons\">Starting daemons</h2>\n<pre><code class=\"language-bash\">rc.d start app1  \nrc.d start app2\n</code></pre>\n<p>Make it permanent in /etc/rc.conf by adding them in the DAEMONS variable.</p>\n<pre><code class=\"language-bash\">...\nDAEMONS=(... app1 app2) \n</code></pre>\n<h2 id=\"nginx-as-a-front-end-proxy-server\">Nginx, as a front end proxy server</h2>\n<p>Install nginx using pacman.</p>\n<p>Edit <code>/etc/nginx/conf/nginx.conf</code></p>\n<pre><code class=\"language-nginx\">...  \n    server {  \n        listen 80;  \n        server_name app2.archdemo;  \n        location / {  \n          proxy_pass http://127.0.0.1:9002;  \n          proxy\\_set\\_header Host $host;  \n          proxy\\_set\\_header X-Forwarded-For $proxy\\_add\\_x\\_forwarded\\_for;  \n          proxy\\_set\\_header X-Forwarded-Host $host;  \n          proxy\\_set\\_header X-Forwarded-Port $server_port;  \n          proxy\\_set\\_header X-Forwarded-Proto https;  \n        }  \n    }  \n    server {  \n        listen 80;  \n        server_name app1.archdemo;  \n        location / {  \n          proxy_pass http://127.0.0.1:9001;  \n          proxy\\_set\\_header Host $host;  \n          proxy\\_set\\_header X-Forwarded-For $proxy\\_add\\_x\\_forwarded\\_for;  \n          proxy\\_set\\_header X-Forwarded-Host $host;  \n          proxy\\_set\\_header X-Forwarded-Port $server_port;  \n          proxy\\_set\\_header X-Forwarded-Proto https;  \n        }  \n    }  \n...\n</code></pre>\n","data":{"title":"How to deploy your play applications on ArchLinux with daemons","description":"This video shows how to run different instances of Play framework server in the most Linux friendly way: using daemons. Example with ArchLinux, using yaourt, the playframework AUR package and nginx.","author":"Gaetan","layout":"post","permalink":"/2011/10/how-to-deploy-your-play-applications-on-archlinux-with-daemons/","tags":["sysadmin","linux","playframework"]}},"__N_SSG":true}
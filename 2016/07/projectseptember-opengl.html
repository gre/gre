<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="author" content="GaÃ«tan Renaudeau"/><meta name="description"/><meta name="keywords" content="react, opengl, gl-react"/><meta name="HandheldFriendly" content="True"/><meta name="MobileOptimized" content="320"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@greweb"/><meta name="twitter:title" content="ðŸŽ‰ There are some OpenGL in the Project September fashion app!"/><meta name="og:title" content="ðŸŽ‰ There are some OpenGL in the Project September fashion app!"/><meta name="twitter:creator" content="@greweb"/><title>@greweb - ðŸŽ‰ There are some OpenGL in the Project September fashion app!</title><link href="http://fonts.googleapis.com/css?family=Fredericka+the+Great|Arapey|Roboto:400,700,400italic" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/styles/default.min.css"/><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/highlight.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/javascript.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/cpp.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/glsl.min.js"></script><link rel="stylesheet" href="/style/main.css"/><meta name="next-head-count" content="21"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-c914a1e31212c00c738a.js" defer=""></script><script src="/_next/static/chunks/framework-bdc1b4e5e48979e16d36.js" defer=""></script><script src="/_next/static/chunks/main-3b0c517193ca5150f81f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c981e0e3ce59f13eb8d0.js" defer=""></script><script src="/_next/static/chunks/5988-738c1ea5f97353b6463e.js" defer=""></script><script src="/_next/static/chunks/2242-d7350c4a4015a6e6ffc2.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bslug%5D-476d7e87469cc8a40c59.js" defer=""></script><script src="/_next/static/xGHWtvv-i6wBIbJuQOjBy/_buildManifest.js" defer=""></script><script src="/_next/static/xGHWtvv-i6wBIbJuQOjBy/_ssgManifest.js" defer=""></script><style id="__jsx-2519965637">.block.jsx-2519965637{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.block.jsx-2519965637 .right.jsx-2519965637{padding:10px;}.block.jsx-2519965637 .social.jsx-2519965637{margin-top:10px;}.block.jsx-2519965637 .social.jsx-2519965637 a.jsx-2519965637{padding:10px;}.block.jsx-2519965637 .social.jsx-2519965637 img.jsx-2519965637{height:20px;}</style><style id="__jsx-3621368397">.container.jsx-3621368397{min-height:100vh;padding:0 0.5rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style id="__jsx-3469673304">html,body{padding:0;margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto, Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue, sans-serif;}*{box-sizing:border-box;}a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}a:hover,a:active{-webkit-text-decoration:underline;text-decoration:underline;}</style></head><body><div id="__next"><div class="jsx-3621368397 container"><div id="container"><div id="main"><div id="content"><article><header><h1><a href="/">ðŸŽ‰ There are some OpenGL in the Project September fashion app!</a></h1><time class="date" dateTime="2016-07-01">2016-07-01</time><span class="tags"><a class="tag">react</a><a class="tag">opengl</a><a class="tag">gl-react</a></span></header><div class="entry-content"><p>ðŸŽ‰ Hooray! <a href="https://twitter.com/ProjSeptEng">We</a> recently released an iOS app called <a href="https://projectseptember.com">Project September</a>.</p>
<p>This application is built with nice tech stack including <a href="http://facebook.github.io/react-native/">React Native</a> and <a href="http://graphql.org/">GraphQL</a>. The backend is powered by <a href="http://scala-lang.org/">Scala</a>, a robust functional language, and we use many other <a href="https://twitter.com/ProjSeptEng">cool techs</a>.</p>
<p>This fashion app needed some fancy features: one was demo-ed at last <a href="/2016/06/glreactconf">React.js conference</a> with the ability to do localized blur on text over images.</p>
<p>We have developed <strong><a href="https://github.com/ProjectSeptemberInc/gl-react"><code>gl-react</code></a></strong> to abstract GL in React paradigm â€“ with two companion libraries <a href="https://github.com/ProjectSeptemberInc/gl-react-dom"><code>gl-react-dom</code></a> and <a href="https://github.com/ProjectSeptemberInc/gl-react-native"><code>gl-react-native</code></a> that glues React Native with OpenGL.</p>
<p>Let&#39;s first see 2 demos of OpenGL usage in our app, and then we&#39;ll write a bit about how it&#39;s hard to get animations right.</p>
<!--more-->

<h2 id="the-text-over-image-blur">The Text Over Image blur</h2>
<h3 id="the-goal">The goal</h3>
<p><img width="50%" src="/images/2016/07/current-1.png" /><img width="50%" src="/images/2016/07/current-2.png" /></p>
<h3 id="how-it-works">How it works</h3>
<img src="/images/2016/07/initial.png" />

<p><strong>+</strong> <strong><em>(layer)</em></strong></p>
<img src="/images/2016/07/layer.png" />

<p><strong>=</strong></p>
<img src="/images/2016/07/result.png" />

<h3 id="under-the-hood">Under the hood</h3>
<ul>
<li>The shadow intensity, size, position, is procedurally generated, we can adjust that. The shadow color is the blurry image color</li>
<li>The text color is determined by the color picked in blurred image at the shadow middle position. <strong>If the <code>monochrome</code> value of that color is lower than 60%</strong>, text will be white, otherwise text will be black.</li>
</ul>
<p>Here is more detail on how the shadow is generated:</p>
<img src="/images/2016/07/under-1.png" />

<p><strong>* (multiply alpha)</strong></p>
<img src="/images/2016/07/under-2.png" />

<p><strong>=</strong></p>
<img src="/images/2016/07/under-3.png" />

<p><strong>+ (layer)</strong></p>
<img src="/images/2016/07/under-4.png" />

<p><strong>=</strong></p>
<img src="/images/2016/07/layer.png" />

<h3 id="fragment-shader">Fragment shader</h3>
<pre><code class="language-glsl">precision highp float;
varying vec2 uv;

uniform sampler2D img;
uniform sampler2D imgBlurred;
uniform sampler2D txt;

const vec2 shadowCenter = vec2(0.5, 0.9);
const vec2 shadowSize = vec2(0.6, 0.2);
float shadow () {
  return 0.8 * smoothstep(1.0, 0.2, distance(uv / shadowSize, shadowCenter / shadowSize));
}
float monochrome (vec3 c) {
  return 0.2125 * c.r + 0.7154 * c.g + 0.0721 * c.b;
}
vec3 textColor (vec3 bg) {
  return vec3(step(monochrome(bg), 0.6));
}

void main () {
  vec4 bg = mix(texture2D(img, uv), texture2D(imgBlurred, uv), shadow());
  vec4 fg = vec4(textColor(texture2D(imgBlurred, shadowCenter).rgb), 1.0);
  float fgFactor = 1.0 - texture2D(txt, uv).r;
  gl_FragColor = mix(bg, fg, fgFactor);
}
</code></pre>
<h3 id="integration">Integration</h3>
<pre><code class="language-html">&lt;GL.Node shader=&quot;{shaders.textOverImage}&quot;&gt;
  &lt;GL.Uniform name=&quot;img&quot;&gt; {img} &lt;/GL.Uniform&gt;
  &lt;GL.Uniform name=&quot;imgBlurred&quot;&gt;
    &lt;Blur factor=&quot;{20}&quot; passes=&quot;{6}&quot; width=&quot;{width}&quot; height=&quot;{height}&quot;&gt;
      {img}
    &lt;/Blur&gt;
  &lt;/GL.Uniform&gt;
  &lt;GL.Uniform name=&quot;txt&quot;&gt;
    &lt;Text style=&quot;{titleStyle}&quot;&gt;{title}&lt;/Text&gt;
  &lt;/GL.Uniform&gt;
&lt;/GL.Node&gt;
</code></pre>
<h2 id="uploading-thumbnail">Uploading Thumbnail</h2>
<p>This is a video record of our app:</p>
<p><video controls autoplay muted loop width="100%" src="/images/2016/07/upload.mp4"></video></p>
<p>The uploading spinner effect is implemented with an OpenGL shader. This was not easy to avoid all the blinks we used to have. We have different components to render each step (uploading animation / uploaded final image) and the uploaded image needs to be downloaded again to not render as white. One solution could be to use a monolithic &quot;thumbnail&quot; component that do everything. We wanted to keep independent components.
Hopefully, everything now works seamlessly with some &quot;double buffering&quot;/swapping mechanism we will explained at the end of this article.</p>
<h2 id="animate-all-the-things">Animate all the things</h2>
<h3 id="designing-animations">Designing animations</h3>
<blockquote>
<p>Fluid, meaningful animations are essential to the mobile user experience.
<strong><a href="https://facebook.github.io/react-native/docs/animations.html">â€” React Native Animations documentation</a></strong></p>
</blockquote>
<p>It&#39;s not easy to design how an application should animate, to define transitions between all the different possible single state and edge-cases of your app. Designing animations, as part of UX design, is a time consuming work but it tends to be underestimated while being essential for moving from a <em>good app</em> to a <em>very good app</em>. That tends to be the last 20% remaining missing parts of your app that are the hardest but that makes the 80% of a great UX.</p>
<h3 id="implementing-animations">Implementing animations</h3>
<p>Not only it&#39;s hard to have figured out the animations (to find the optimal UX) but it can also be quite challenging to implement them in a maintainable and robust way. Turns out most of the times, your code is not ready for it and it implies big refactoring.</p>
<h4 id="in-react-native">in React Native</h4>
<p>React Native <a href="https://facebook.github.io/react-native/docs/animations.html">Animations API</a> makes it easier: you just have to switch to one of the <code>Animated.*</code> component. In <code>gl-react</code> we even support Animated values to flow into the shaders uniforms so it&#39;s very convenient to animate a GL effect.</p>
<p>That said, React Native Animations is not the ultimate silver bullet. There are things Animations won&#39;t solve for you. React Native Animated is still a low level API, it&#39;s also imperative and not opinionated on how you should turn it into descriptive paradigm.</p>
<p>I guess what&#39;s generally hard with animations in React functional/descriptive paradigm (&quot;always <code>render()</code>ing Virtual DOM again&quot; idea) is to figure out <strong>how to not &quot;break&quot; your animations</strong>. For instance, ugly animation interruption could happen if you <code>render()</code> a different component: because it forces the component to unmount. If you have an animation happening, you might not want it to stop, or at least you might want to smoothly customize the transition to the new state.</p>
<p>That&#39;s something CSS transitions might help solving, but in React Native we don&#39;t have them, so it&#39;s not so trivial.</p>
<h5 id="our-current-solution">our current solution</h5>
<p>We have built our own abstraction to solve this problem: a Component decorator manages to kill a lot of flashes and blinks cases (e.g. images not ready yet, animation getting interrupted).</p>
<blockquote>
<p>What the decoration solves: when moving from A to B, you want B to be ready (e.g. images are loaded), you also want A to have finish its (animated) work.</p>
</blockquote>
<p><strong>A component can express it needs some time to mount <em>(e.g. an image to load!)</em> OR that it needs some time to unmount <em>(e.g. an &quot;animating out&quot;)</em>. This will basically hold the rendering to happen:</strong></p>
<p>The decoration can implement &quot;double buffering&quot; on a Component: <code>render()</code> function keeps rendering Component with the previous &quot;stable props&quot; but will also render in background another instance of Component with the next props. When that next props Component is ready and loaded, we can successful swap it to be the new &quot;stable props&quot;.</p>
<p>You have the basic idea, the decorator is not so trivial to implement as it also needs to handle some edge-cases, for instance if the decorator receives new props during the transition. We also have a minimal way to express &quot;styles transitions&quot; similarly to how CSS Transitions works.</p>
</div><footer><div class="jsx-2519965637 block"><img src="http://greweb.me/logo.svg" width="100" class="jsx-2519965637"/><div class="jsx-2519965637 right"><div class="jsx-2519965637 description">As a generative plotter artist, I use code to create art (creative coding), draw with fountain pens on robots (plotting), and explore the boundaries of abstract art using algorithms in pursuit of increasingly realistic imagery. I do not produce prints; instead, I create unique &#x27;plots&#x27; - physical works of art that are truly one-of-a-kind.</div><div class="jsx-2519965637 social"><a href="https://discord.gg/DQBajxzn" class="jsx-2519965637"><img alt="" src="/icons/discord.svg" class="jsx-2519965637"/></a><a href="https://twitter.com/greweb" class="jsx-2519965637"><img alt="" src="/icons/twitter.svg" class="jsx-2519965637"/></a><a href="https://instagram.com/greweb" class="jsx-2519965637"><img alt="" src="/icons/instagram.svg" class="jsx-2519965637"/></a><a href="https://twitch.tv/greweb" class="jsx-2519965637"><img alt="" src="/icons/twitch.svg" class="jsx-2519965637"/></a><a href="https://github.com/gre" class="jsx-2519965637"><img alt="" src="/icons/github.svg" class="jsx-2519965637"/></a><a href="https://opensea.io/greweb?tab=created" class="jsx-2519965637"><img alt="" src="/icons/eth.svg" class="jsx-2519965637"/></a><a href="https://fxhash.xyz/u/greweb" class="jsx-2519965637"><img alt="" src="/icons/tz.svg" class="jsx-2519965637"/></a><a href="https://greweb.itch.io" class="jsx-2519965637"><img alt="" src="/icons/iconmonstr-gamepad-3.svg" class="jsx-2519965637"/></a></div></div></div></footer></article></div></div></div><script>hljs.highlightAll();</script></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"2016-07-01-projectseptember-opengl","year":"2016","month":"07","day":"01","slug":"projectseptember-opengl","content":"\u003cp\u003eðŸŽ‰ Hooray! \u003ca href=\"https://twitter.com/ProjSeptEng\"\u003eWe\u003c/a\u003e recently released an iOS app called \u003ca href=\"https://projectseptember.com\"\u003eProject September\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThis application is built with nice tech stack including \u003ca href=\"http://facebook.github.io/react-native/\"\u003eReact Native\u003c/a\u003e and \u003ca href=\"http://graphql.org/\"\u003eGraphQL\u003c/a\u003e. The backend is powered by \u003ca href=\"http://scala-lang.org/\"\u003eScala\u003c/a\u003e, a robust functional language, and we use many other \u003ca href=\"https://twitter.com/ProjSeptEng\"\u003ecool techs\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThis fashion app needed some fancy features: one was demo-ed at last \u003ca href=\"/2016/06/glreactconf\"\u003eReact.js conference\u003c/a\u003e with the ability to do localized blur on text over images.\u003c/p\u003e\n\u003cp\u003eWe have developed \u003cstrong\u003e\u003ca href=\"https://github.com/ProjectSeptemberInc/gl-react\"\u003e\u003ccode\u003egl-react\u003c/code\u003e\u003c/a\u003e\u003c/strong\u003e to abstract GL in React paradigm â€“ with two companion libraries \u003ca href=\"https://github.com/ProjectSeptemberInc/gl-react-dom\"\u003e\u003ccode\u003egl-react-dom\u003c/code\u003e\u003c/a\u003e and \u003ca href=\"https://github.com/ProjectSeptemberInc/gl-react-native\"\u003e\u003ccode\u003egl-react-native\u003c/code\u003e\u003c/a\u003e that glues React Native with OpenGL.\u003c/p\u003e\n\u003cp\u003eLet\u0026#39;s first see 2 demos of OpenGL usage in our app, and then we\u0026#39;ll write a bit about how it\u0026#39;s hard to get animations right.\u003c/p\u003e\n\u003c!--more--\u003e\n\n\u003ch2 id=\"the-text-over-image-blur\"\u003eThe Text Over Image blur\u003c/h2\u003e\n\u003ch3 id=\"the-goal\"\u003eThe goal\u003c/h3\u003e\n\u003cp\u003e\u003cimg width=\"50%\" src=\"/images/2016/07/current-1.png\" /\u003e\u003cimg width=\"50%\" src=\"/images/2016/07/current-2.png\" /\u003e\u003c/p\u003e\n\u003ch3 id=\"how-it-works\"\u003eHow it works\u003c/h3\u003e\n\u003cimg src=\"/images/2016/07/initial.png\" /\u003e\n\n\u003cp\u003e\u003cstrong\u003e+\u003c/strong\u003e \u003cstrong\u003e\u003cem\u003e(layer)\u003c/em\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cimg src=\"/images/2016/07/layer.png\" /\u003e\n\n\u003cp\u003e\u003cstrong\u003e=\u003c/strong\u003e\u003c/p\u003e\n\u003cimg src=\"/images/2016/07/result.png\" /\u003e\n\n\u003ch3 id=\"under-the-hood\"\u003eUnder the hood\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eThe shadow intensity, size, position, is procedurally generated, we can adjust that. The shadow color is the blurry image color\u003c/li\u003e\n\u003cli\u003eThe text color is determined by the color picked in blurred image at the shadow middle position. \u003cstrong\u003eIf the \u003ccode\u003emonochrome\u003c/code\u003e value of that color is lower than 60%\u003c/strong\u003e, text will be white, otherwise text will be black.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eHere is more detail on how the shadow is generated:\u003c/p\u003e\n\u003cimg src=\"/images/2016/07/under-1.png\" /\u003e\n\n\u003cp\u003e\u003cstrong\u003e* (multiply alpha)\u003c/strong\u003e\u003c/p\u003e\n\u003cimg src=\"/images/2016/07/under-2.png\" /\u003e\n\n\u003cp\u003e\u003cstrong\u003e=\u003c/strong\u003e\u003c/p\u003e\n\u003cimg src=\"/images/2016/07/under-3.png\" /\u003e\n\n\u003cp\u003e\u003cstrong\u003e+ (layer)\u003c/strong\u003e\u003c/p\u003e\n\u003cimg src=\"/images/2016/07/under-4.png\" /\u003e\n\n\u003cp\u003e\u003cstrong\u003e=\u003c/strong\u003e\u003c/p\u003e\n\u003cimg src=\"/images/2016/07/layer.png\" /\u003e\n\n\u003ch3 id=\"fragment-shader\"\u003eFragment shader\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-glsl\"\u003eprecision highp float;\nvarying vec2 uv;\n\nuniform sampler2D img;\nuniform sampler2D imgBlurred;\nuniform sampler2D txt;\n\nconst vec2 shadowCenter = vec2(0.5, 0.9);\nconst vec2 shadowSize = vec2(0.6, 0.2);\nfloat shadow () {\n  return 0.8 * smoothstep(1.0, 0.2, distance(uv / shadowSize, shadowCenter / shadowSize));\n}\nfloat monochrome (vec3 c) {\n  return 0.2125 * c.r + 0.7154 * c.g + 0.0721 * c.b;\n}\nvec3 textColor (vec3 bg) {\n  return vec3(step(monochrome(bg), 0.6));\n}\n\nvoid main () {\n  vec4 bg = mix(texture2D(img, uv), texture2D(imgBlurred, uv), shadow());\n  vec4 fg = vec4(textColor(texture2D(imgBlurred, shadowCenter).rgb), 1.0);\n  float fgFactor = 1.0 - texture2D(txt, uv).r;\n  gl_FragColor = mix(bg, fg, fgFactor);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"integration\"\u003eIntegration\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026lt;GL.Node shader=\u0026quot;{shaders.textOverImage}\u0026quot;\u0026gt;\n  \u0026lt;GL.Uniform name=\u0026quot;img\u0026quot;\u0026gt; {img} \u0026lt;/GL.Uniform\u0026gt;\n  \u0026lt;GL.Uniform name=\u0026quot;imgBlurred\u0026quot;\u0026gt;\n    \u0026lt;Blur factor=\u0026quot;{20}\u0026quot; passes=\u0026quot;{6}\u0026quot; width=\u0026quot;{width}\u0026quot; height=\u0026quot;{height}\u0026quot;\u0026gt;\n      {img}\n    \u0026lt;/Blur\u0026gt;\n  \u0026lt;/GL.Uniform\u0026gt;\n  \u0026lt;GL.Uniform name=\u0026quot;txt\u0026quot;\u0026gt;\n    \u0026lt;Text style=\u0026quot;{titleStyle}\u0026quot;\u0026gt;{title}\u0026lt;/Text\u0026gt;\n  \u0026lt;/GL.Uniform\u0026gt;\n\u0026lt;/GL.Node\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"uploading-thumbnail\"\u003eUploading Thumbnail\u003c/h2\u003e\n\u003cp\u003eThis is a video record of our app:\u003c/p\u003e\n\u003cp\u003e\u003cvideo controls autoplay muted loop width=\"100%\" src=\"/images/2016/07/upload.mp4\"\u003e\u003c/video\u003e\u003c/p\u003e\n\u003cp\u003eThe uploading spinner effect is implemented with an OpenGL shader. This was not easy to avoid all the blinks we used to have. We have different components to render each step (uploading animation / uploaded final image) and the uploaded image needs to be downloaded again to not render as white. One solution could be to use a monolithic \u0026quot;thumbnail\u0026quot; component that do everything. We wanted to keep independent components.\nHopefully, everything now works seamlessly with some \u0026quot;double buffering\u0026quot;/swapping mechanism we will explained at the end of this article.\u003c/p\u003e\n\u003ch2 id=\"animate-all-the-things\"\u003eAnimate all the things\u003c/h2\u003e\n\u003ch3 id=\"designing-animations\"\u003eDesigning animations\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eFluid, meaningful animations are essential to the mobile user experience.\n\u003cstrong\u003e\u003ca href=\"https://facebook.github.io/react-native/docs/animations.html\"\u003eâ€” React Native Animations documentation\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIt\u0026#39;s not easy to design how an application should animate, to define transitions between all the different possible single state and edge-cases of your app. Designing animations, as part of UX design, is a time consuming work but it tends to be underestimated while being essential for moving from a \u003cem\u003egood app\u003c/em\u003e to a \u003cem\u003every good app\u003c/em\u003e. That tends to be the last 20% remaining missing parts of your app that are the hardest but that makes the 80% of a great UX.\u003c/p\u003e\n\u003ch3 id=\"implementing-animations\"\u003eImplementing animations\u003c/h3\u003e\n\u003cp\u003eNot only it\u0026#39;s hard to have figured out the animations (to find the optimal UX) but it can also be quite challenging to implement them in a maintainable and robust way. Turns out most of the times, your code is not ready for it and it implies big refactoring.\u003c/p\u003e\n\u003ch4 id=\"in-react-native\"\u003ein React Native\u003c/h4\u003e\n\u003cp\u003eReact Native \u003ca href=\"https://facebook.github.io/react-native/docs/animations.html\"\u003eAnimations API\u003c/a\u003e makes it easier: you just have to switch to one of the \u003ccode\u003eAnimated.*\u003c/code\u003e component. In \u003ccode\u003egl-react\u003c/code\u003e we even support Animated values to flow into the shaders uniforms so it\u0026#39;s very convenient to animate a GL effect.\u003c/p\u003e\n\u003cp\u003eThat said, React Native Animations is not the ultimate silver bullet. There are things Animations won\u0026#39;t solve for you. React Native Animated is still a low level API, it\u0026#39;s also imperative and not opinionated on how you should turn it into descriptive paradigm.\u003c/p\u003e\n\u003cp\u003eI guess what\u0026#39;s generally hard with animations in React functional/descriptive paradigm (\u0026quot;always \u003ccode\u003erender()\u003c/code\u003eing Virtual DOM again\u0026quot; idea) is to figure out \u003cstrong\u003ehow to not \u0026quot;break\u0026quot; your animations\u003c/strong\u003e. For instance, ugly animation interruption could happen if you \u003ccode\u003erender()\u003c/code\u003e a different component: because it forces the component to unmount. If you have an animation happening, you might not want it to stop, or at least you might want to smoothly customize the transition to the new state.\u003c/p\u003e\n\u003cp\u003eThat\u0026#39;s something CSS transitions might help solving, but in React Native we don\u0026#39;t have them, so it\u0026#39;s not so trivial.\u003c/p\u003e\n\u003ch5 id=\"our-current-solution\"\u003eour current solution\u003c/h5\u003e\n\u003cp\u003eWe have built our own abstraction to solve this problem: a Component decorator manages to kill a lot of flashes and blinks cases (e.g. images not ready yet, animation getting interrupted).\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWhat the decoration solves: when moving from A to B, you want B to be ready (e.g. images are loaded), you also want A to have finish its (animated) work.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003eA component can express it needs some time to mount \u003cem\u003e(e.g. an image to load!)\u003c/em\u003e OR that it needs some time to unmount \u003cem\u003e(e.g. an \u0026quot;animating out\u0026quot;)\u003c/em\u003e. This will basically hold the rendering to happen:\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eThe decoration can implement \u0026quot;double buffering\u0026quot; on a Component: \u003ccode\u003erender()\u003c/code\u003e function keeps rendering Component with the previous \u0026quot;stable props\u0026quot; but will also render in background another instance of Component with the next props. When that next props Component is ready and loaded, we can successful swap it to be the new \u0026quot;stable props\u0026quot;.\u003c/p\u003e\n\u003cp\u003eYou have the basic idea, the decorator is not so trivial to implement as it also needs to handle some edge-cases, for instance if the decorator receives new props during the transition. We also have a minimal way to express \u0026quot;styles transitions\u0026quot; similarly to how CSS Transitions works.\u003c/p\u003e\n","data":{"title":"ðŸŽ‰ There are some OpenGL in the Project September fashion app!","author":"Gaetan","layout":"post","tags":["react","opengl","gl-react"]}},"__N_SSG":true},"page":"/[year]/[month]/[slug]","query":{"year":"2016","month":"07","slug":"projectseptember-opengl"},"buildId":"xGHWtvv-i6wBIbJuQOjBy","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="author" content="GaÃ«tan Renaudeau"/><meta name="description" content="gl-react has been reimplemented from scratch, feedback from previous mistake and overview of new features."/><meta name="keywords" content="react, gl-react, webgl"/><meta name="HandheldFriendly" content="True"/><meta name="MobileOptimized" content="320"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@greweb"/><meta name="twitter:title" content="gl-react v3"/><meta name="og:title" content="gl-react v3"/><meta name="twitter:description" content="gl-react has been reimplemented from scratch, feedback from previous mistake and overview of new features."/><meta name="twitter:creator" content="@greweb"/><meta name="og:image" content="http://greweb.me//images/2016/12/thumbnail.png"/><meta name="twitter:image" content="http://greweb.me//images/2016/12/thumbnail.png"/><link rel="image_src" href="http://greweb.me//images/2016/12/thumbnail.png"/><title>@greweb - gl-react v3</title><link href="http://fonts.googleapis.com/css?family=Fredericka+the+Great|Arapey|Roboto:400,700,400italic" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/styles/default.min.css"/><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/highlight.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/javascript.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/cpp.min.js"></script><script src="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/languages/glsl.min.js"></script><link rel="stylesheet" href="/style/main.css"/><meta name="next-head-count" content="25"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-11911496995bbdbf52b1.js" defer=""></script><script src="/_next/static/chunks/framework-c93ed74a065331c4bd75.js" defer=""></script><script src="/_next/static/chunks/main-005750ed97c879f2d59b.js" defer=""></script><script src="/_next/static/chunks/pages/_app-092526a60f8cb7d1b3d6.js" defer=""></script><script src="/_next/static/chunks/988-83f401159b53b3fa4628.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bslug%5D-098b94d3fea72f3bf0b3.js" defer=""></script><script src="/_next/static/Zokw2miiDZwMJvb6cOfQx/_buildManifest.js" defer=""></script><script src="/_next/static/Zokw2miiDZwMJvb6cOfQx/_ssgManifest.js" defer=""></script><style id="__jsx-2519965637">.block.jsx-2519965637{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.block.jsx-2519965637 .right.jsx-2519965637{padding:10px;}.block.jsx-2519965637 .social.jsx-2519965637{margin-top:10px;}.block.jsx-2519965637 .social.jsx-2519965637 a.jsx-2519965637{padding:10px;}.block.jsx-2519965637 .social.jsx-2519965637 img.jsx-2519965637{height:20px;}</style><style id="__jsx-3621368397">.container.jsx-3621368397{min-height:100vh;padding:0 0.5rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style id="__jsx-3469673304">html,body{padding:0;margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto, Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue, sans-serif;}*{box-sizing:border-box;}a{color:inherit;-webkit-text-decoration:none;text-decoration:none;}a:hover,a:active{-webkit-text-decoration:underline;text-decoration:underline;}</style></head><body><div id="__next"><div class="jsx-3621368397 container"><div id="container"><div id="main"><div id="content"><article><header><h1><a href="/">gl-react v3</a></h1><time class="date" dateTime="2016-12-03">2016-12-03</time><span class="tags"><a class="tag">react</a><a class="tag">gl-react</a><a class="tag">webgl</a></span></header><div class="entry-content"><h1 id="happy-to-release-httpsgl-react-cookbooksurgesh-containing-43-unique-examples-and-api-documentation">Happy to release <strong><a href="https://gl-react-cookbook.surge.sh">https://gl-react-cookbook.surge.sh</a></strong> containing 43 unique examples and API documentation!</h1>
<p><a href="https://gl-react-cookbook.surge.sh"><img src="/images/2016/12/gl-react-v3.gif" alt=""></a></p>
<blockquote>
<p>If you don&#39;t want to be &quot;spoiled&quot; by this article, go through <a href="https://gl-react-cookbook.surge.sh">the cookbook examples</a>. This article will explore some of them.</p>
</blockquote>
<!--more-->

<h2 id="gl-react-has-been-rewritten-from-scratch">gl-react has been rewritten from scratch</h2>
<p><strong>gl-react v3 is a complete rewrite of the v2 implementation for better performance and compatibility with React paradigm.</strong></p>
<p>This is not yet published on NPM as it&#39;s <a href="https://github.com/gre/gl-react">still in development</a> (the Web version is pretty ready, React Native version is not implemented).</p>
<p>Most features provided by gl-react v2 are preserved (API haven&#39;t changed, <a href="https://gl-react-cookbook.surge.sh/hellogl">see how similar is the HelloGL example</a>), but v3 fixes most Github issues accumulated for a year.</p>
<h3 id="the-biggest-mistake-of-the-previous-implementation">The biggest mistake of the previous implementation</h3>
<p>If there is one lesson learned from previous gl-react implementation: <strong>&quot;unfolding&quot; / consuming the <code>children</code> prop by yourself is (probably) wrong, let React solve this job!</strong> Using React, you can benefit <a href="https://facebook.github.io/react/docs/reconciliation.html">React reconciliation and diff algorithm</a>.
In other words, always prefer to keep users&#39; VDOM tree rather than consuming it with <code>React.Children.*</code> functions.</p>
<p>I feel dumb not having discovered this before, but if you are not actually rendering DOM it&#39;s an easy path for a library to just map, traverse, consume the children tree and just render what you needs (like just a <code>&lt;canvas/&gt;</code>). But this is probably a mistake! First, this makes it impossible to use React Devtools and see the original tree, but more importantly, it breaks interoperability with other libraries (e.g. don&#39;t forbid someone to use <a href="https://github.com/chenglou/react-motion">react-motion</a> or <a href="https://github.com/ReactTraining/react-router">React Router</a> in the middle of your components!).</p>
<p>A better idea is to preserve the user <code>children</code>. Keep your logic in each Component and use the React lifecycle to create and destroy things, and <strong>use <a href="https://facebook.github.io/react/docs/context.html">React context</a> to connect children to parent</strong>.</p>
<blockquote>
<p>You should better keep user <code>children</code>, even if it means rendering it in an empty <code>&lt;span&gt;</code>, <em>current workaround of <code>gl-react</code>, looking forward to hearing from you, idea inspired from the great <a href="https://github.com/FormidableLabs/react-music">react-music</a></em></p>
</blockquote>
<h3 id="what-it-means-for-gl-react">What it means for gl-react</h3>
<p>The gl-react v3 implementation truly uses React lifecycle: <strong>a React Component update triggers a GL redraw</strong>. That way, <code>shouldComponentUpdate</code> allows to do partial GL re-rendering. Each Node holds a <a href="https://www.opengl.org/wiki/Framebuffer_Object">framebuffer object</a> (created on mount, destroyed on unmount) that only get redrawn when component updates and schedules a Surface reflow.</p>
<p><code>&lt;Node&gt;</code> receives the <code>gl: WebGLRenderingContext</code> from the ancestor <code>&lt;Surface&gt;</code> thanks to <a href="https://facebook.github.io/react/docs/context.html">React context</a>. There is also a <code>glParent</code> context (a Surface or another Node) that is used to make GL components discoverable each other so we can build a dependency graph. This dependency graph allows to implement the correct <code>draw</code> pipeline (and it&#39;s pretty trivial, see <a href="#under_the_hook_redraw"><em>Section &quot;under the hood of Surface and Node redraw&quot;</em></a>).</p>
<h2 id="bus-a-better-way-to-share-computation"><code>&lt;Bus&gt;</code>, a better way to share computation</h2>
<p><a href="http://greweb.me/2016/06/glreactconf/">gl-react used to automatically factorize the duplicates elements of the GL tree</a> but <strong>it has been decided to remove this feature</strong>: <em>This was actually a complex mechanism (a bit too &quot;magic&quot;), hard to implement and a premature optimization that can have slower performance.</em></p>
<p>The new gl-react embraces the React paradigm: The new way to express a Graph (and share computation) is <strong>using a <a href="https://gl-react-cookbook.surge.sh/api#bus"><code>&lt;Bus&gt;</code></a></strong>...</p>
<h3 id="the-ref-pattern">The <code>`()=&gt;ref`</code> pattern</h3>
<p>The problem we want to solve is to <strong>express a graph with React</strong>, which, at first glance, only allow to represent trees, not graphs!</p>
<p>The way we can solve this is by using refs and a &quot;ref getter function&quot;:</p>
<ol>
<li><strong>a Bus with a ref:</strong> <code>&lt;Bus ref=&quot;myBus&quot;&gt;{content to inject}&lt;/Bus&gt;</code>.</li>
<li><strong>pass a function that resolves the ref</strong> to pipe Bus into another Node. e.g: <code>()=&gt;this.refs.myBus</code>.</li>
</ol>
<p><a href="https://gl-react-cookbook.surge.sh/blurmapdyn">blurmapdyn example <img src="/images/2016/12/blurmapdyn.gif" alt=""></a>
a single ConicalGradient should be used for all blur pass:
<img src="/images/2016/12/blurmapdynschema.png" alt=""></p>
<p>There are a few other good examples of ref usages:</p>
<ul>
<li><a href="https://gl-react-cookbook.surge.sh/blurmapmouse">blurmapmouse</a></li>
<li><a href="https://gl-react-cookbook.surge.sh/blurimgtitle">blurimgtitle</a> (same example that was features in 2016 React conf!)</li>
<li><a href="https://gl-react-cookbook.surge.sh/behindasteroids">behindasteroids</a>, crazy port of a game I made for js13k.</li>
</ul>
<blockquote>
<p>The <code>()=&gt;ref</code> pattern works only if you call the function after component did update (refs are set at this time).</p>
</blockquote>
<h2 id="the-good-ol-children-function">The good ol&#39; children function</h2>
<p>There is another pattern for more specific needs: instead of composing by giving an element, you can also compose by giving a <strong>Function that returns an element</strong>. Why that? Because, it&#39;s a way to nicely give you the redraw function: <code>redraw =&gt; &lt;Video onFrame={redraw} /&gt;</code>:</p>
<p><a href="https://gl-react-cookbook.surge.sh/video?menu=true">Checkout video example <img src="/images/2016/12/videoredraw.png" alt=""></a></p>
<blockquote>
<p>We really just want to redraw if there is a new video frame.</p>
</blockquote>
<p>We have merged the 2 patterns into one: if you provide a function, it&#39;s just called with <code>redraw</code>, and the returned value is used as a texture. We have a few cases to detect what kind of texture it is (and also an <a href="https://gl-react-cookbook.surge.sh/api#textureloaders">extensible mechanism</a> used by implementations to load platform specific objects).
<a href="https://github.com/gre/gl-react/blob/a33e6aa685479d588646b20dd62e1e25a64a5a47/packages/gl-react/src/Node.js#L704-L783">(checkout this if you want to see the code)</a></p>
<h2 id="node-backbuffering--backbuffer-symbol">Node backbuffering &amp; Backbuffer symbol</h2>
<p>A new feature allows to inject the previous Node state as a texture. This is called backbuffering. One simple usecase is to implement Motion Blur persistence (like the GIF on top of this article).</p>
<p>We can also accumulate a state, for instance, to implement Game of Life!</p>
<p><a href="https://gl-react-cookbook.surge.sh/golglider">Game of life glider example <img src="/images/2016/12/gol.gif" alt=""></a></p>
<p>And the whole idea of gl-react (and React) is about composition. For instance, doing a rotating effect of that Game of Life is basically just <code>&lt;Rotate&gt; &lt;GameOfLife /&gt; &lt;/Rotate&gt;</code>.</p>
<p>An interesting part is that you can update the GameOfLife at a rate that is independent from the <strong>Rotate</strong> rendering: just by making GameOfLife a pure component that receives a tick, or implementing shouldComponentUpdate update (you have as many choices as React have to <a href="https://facebook.github.io/react/docs/react-api.html#react.purecomponent">shortcut the rendering</a>).</p>
<p><a href="https://gl-react-cookbook.surge.sh/golrotscu">golrotscu example<img src="/images/2016/12/golrot.gif" alt=""></a></p>
<blockquote>
<p>See the counters that indicate the number of redraw. (the capture preview in the Box only get snapshot each 100ms, but in the real canvas, it runs at 60 FPS)</p>
</blockquote>
<p>Finally, please checkout <a href="https://gl-react-cookbook.surge.sh/ibex">ibex example</a> (extracted from another JS13K game! xD).</p>
<blockquote>
<p>You can&#39;t leave this article before seeing <a href="https://gl-react-cookbook.surge.sh/ibex">ibex example</a>! I&#39;m serious, this is probably the most accomplished code I ever wrote! xD</p>
</blockquote>
<h2 id="-under-the-hood-of-surface-and-node-redraw"><a name="under_the_hook_redraw"></a> under the hood of Surface and Node redraw</h2>
<p>In order to make redraw efficient, <code>gl-react</code> have 2 phases: the <code>redraw()</code> phase and the <code>flush()</code> phase (reflecting the respective methods available both on <code>Surface</code> and <code>Node</code>). This is a bit like a rendering engine:</p>
<ul>
<li><strong><code>redraw()</code> phase</strong> sets a dirty flag to a Node and all its &quot;dependents&quot; (other nodes, buses, surface). <em>redraws happen generally bottom-up to the Surface.</em></li>
<li><strong><code>flush()</code> phase</strong> draws all nodes that have the redraw flag. <em>draws happens top-down from the Surface.</em></li>
</ul>
<p><code>redraw()</code> is directly hooked to React update lifecycle (re-rendering a Node will calls <code>redraw()</code> for you).
To make this system efficient, <strong>the flush() is by default asynchronous</strong>, i.e. <code>redraw()</code> means scheduling a new gl draw.
Surface have a main loop that runs at 60 fps and call <code>flush()</code>. This is very efficient because if Surface does not have the redraw flag, <code>flush()</code> does nothing.</p>
<blockquote>
<p>In gl-react inspector, clicking on the redraw count will call <code>redraw()</code> on the node / bus. We can illustrate that only &quot;dependents&quot; get redrawn using the advanced <a href="https://gl-react-cookbook.surge.sh/blurimgtitle">blurimgtitle example</a>:</p>
</blockquote>
<p><a href="https://gl-react-cookbook.surge.sh/blurimgtitle">only &quot;dependents&quot; get redrawn <img src="/images/2016/12/blurimgtitle-redraw.gif" alt=""></a></p>
<p>This redraw/flush phases allow to prevent and skip rendering multiple times a Node. In some cases, we still want to redraw synchronously: with <code>&lt;Node/&gt;</code> <code>sync</code> prop. For instance, in Game of Life, we don&#39;t want to skip an update (the initial update set the initial GoL state, if it was async it might get skipped).</p>
<h2 id="bonus">Bonus</h2>
<h3 id="flow-types">Flow types</h3>
<p>Flow types has been used for more robust code and better user experience. BTW, <a href="https://github.com/facebook/flow/pull/2764">WebGLRenderingContext will soon be released in flow</a>.</p>
<h3 id="atom-highlighting">Atom highlighting</h3>
<p>If you are using Atom Editor, you can have JS inlined GLSL syntax highlighted.</p>
<p><img src="https://cloud.githubusercontent.com/assets/211411/20623048/0527cce2-b306-11e6-85ee-5020be994c10.png" alt=""></p>
<p><em>To configure this:</em></p>
<ul>
<li>add <code>language-babel</code> package.</li>
<li>Configure <code>language-babel</code> to add <code>GLSL:source.glsl</code> in settings &quot;<em>JavaScript Tagged Template Literal Grammar Extensions</em>&quot;.</li>
<li>(Bonus) Add this CSS to your <em>Atom &gt; Stylesheet</em>:</li>
</ul>
<pre><code class="language-css">/* language-babel blocks */
atom-text-editor::shadow .line .ttl-grammar {
  /* NB: designed for dark theme. can be customized */
  background-color: rgba(0, 0, 0, 0.3);
}
atom-text-editor::shadow .line .ttl-grammar:first-child:last-child {
  display: block; /* force background to take full width only if ttl-grammar is alone in the line. */
}
</code></pre>
<h3 id="tests-almost-100-coverage">Tests: almost 100% coverage!</h3>
<p>The library is tested directly on the command line, thanks to <a href="https://github.com/facebook/jest">Jest</a> and <a href="https://github.com/stackgl/headless-gl">headless-gl</a> <em>(Big up to <a href="https://github.com/mikolalysenko">mikolalysenko</a> for <a href="https://github.com/stackgl/headless-gl">headless-gl</a>!)</em>.
<strong>gl-react have 2000 line of tests, involving a lot of gl calls, and readPixels, and it runs... in a few seconds!</strong> <em>(to Jest devs: you are wizards!)</em></p>
<pre><code>
 PASS  ./all.test.js
  â renders a red shader (75ms)
  â renders HelloGL (15ms)
  â ndarray texture (27ms)
  â renders a color uniform (18ms)
  â composes color uniform with LinearCopy (21ms)
  â no needs to flush if use of sync (24ms)
  â Node can have a different size and be scaled up (18ms)
  â Surface can be resized (32ms)
  â bus uniform code style (17ms)
  â bus example 1 (17ms)
  â bus example 2 (18ms)
  â bus example 3 (17ms)
  â bus example 4 (22ms)
  â bus example 5 (14ms)
  â bus example 6 (24ms)
  â bus: same texture used in multiple sampler2D is fine (14ms)
  â a surface can be captured and resized (16ms)
  â a node can be captured and resized (17ms)
  â Uniform children redraw=&gt;el function (22ms)
  â Bus redraw=&gt;el function (16ms)
  â many Surface updates don&#39;t result of many redraws (18ms)
  â many Surface flush() don&#39;t result of extra redraws (10ms)
  â GL Components that implement shouldComponentUpdate shortcut Surface redraws (27ms)
  â nested GL Component update will re-draw the Surface (24ms)
  â Node `clear` and discard; (24ms)
  â Node `backbuffering` (32ms)
  â Node `backbuffering` in `sync` (36ms)
  â texture can be null (12ms)
  â array of textures (22ms)
  â Node uniformsOptions texture interpolation (17ms)
  â can be extended with addTextureLoaderClass (70ms)
  â Surface `preload` prevent to draw anything (59ms)
  â Surface `preload` that fails will trigger onLoadError (59ms)
  â renders a shader inline in the Node (15ms)
  â testing connectSize() feature (17ms)
  â handle context lost nicely (43ms)
  â Bus#uniform and Bus#index (25ms)
  â VisitorLogger + bunch of funky extreme tests (140ms)

-------------------------------|----------|----------|----------|----------|----------------|
File                           |  % Stmts | % Branch |  % Funcs |  % Lines |Uncovered Lines |
-------------------------------|----------|----------|----------|----------|----------------|
All files                      |    97.85 |     88.8 |    95.96 |    99.35 |                |
 src                           |    97.82 |    88.95 |     95.9 |    99.35 |                |
  Backbuffer.js                |      100 |      100 |      100 |      100 |                |
  Bus.js                       |    96.15 |    74.29 |      100 |      100 |                |
  GLSL.js                      |      100 |       50 |      100 |      100 |                |
  LinearCopy.js                |      100 |      100 |      100 |      100 |                |
  NearestCopy.js               |      100 |      100 |      100 |      100 |                |
  Node.js                      |    97.65 |    92.71 |    97.01 |    99.01 |    214,216,358 |
  Shaders.js                   |      100 |    76.92 |      100 |      100 |                |
  Texture2DLoader.js           |      100 |      100 |      100 |      100 |                |
  TextureLoader.js             |      100 |      100 |      100 |      100 |                |
  TextureLoaderNDArray.js      |      100 |      100 |      100 |      100 |                |
  TextureLoaders.js            |      100 |      100 |      100 |      100 |                |
  Visitor.js                   |      100 |      100 |       75 |      100 |                |
  VisitorLogger.js             |      100 |    92.59 |      100 |      100 |                |
  Visitors.js                  |      100 |      100 |      100 |      100 |                |
  connectSize.js               |      100 |    85.71 |      100 |      100 |                |
  copyShader.js                |      100 |      100 |      100 |      100 |                |
  createSurface.js             |    97.09 |    83.61 |    94.55 |    99.32 |            361 |
  genId.js                     |      100 |      100 |      100 |      100 |                |
  index.js                     |      100 |      100 |      100 |      100 |                |
 src/helpers                   |      100 |       75 |      100 |      100 |                |
  disposable.js                |      100 |       50 |      100 |      100 |                |
  invariantNoDependentsLoop.js |      100 |      100 |      100 |      100 |                |
-------------------------------|----------|----------|----------|----------|----------------|
Test Suites: 1 passed, 1 total
Tests:       38 passed, 38 total
Snapshots:   4 passed, 4 total
Time:        2.655s
Ran all test suites.
</code></pre>
<p>One limitation is that all tests need to be in a single file. <a href="https://github.com/facebook/jest/issues/2029">I created an issue here</a>. I think it&#39;s either an issue in <a href="https://github.com/facebook/jest">Jest</a> or in <a href="https://github.com/stackgl/headless-gl">headless-gl</a>.</p>
<h2 id="tradeoffs-and-remaining-work">Tradeoffs and remaining work</h2>
<p>The library tradeoffs are written in <a href="https://github.com/gre/gl-react/blob/master/TRADEOFFS.md">TRADEOFFS.md</a>. We might cover some unexplored direction in a near future and solve some of them.</p>
<p>v3 is still in development, the main unfinished part is the React Native implementation which is now the main priority of the library.
It will probably rely on an awesome initiative: a React Native WebGL implementation started in Exponent by <a href="https://github.com/nikki93">@nikki</a>!</p>
<p>For more information, see <a href="https://github.com/gre/gl-react#v3-alpha-development-in-progress">v3 alpha: development in progress</a>.</p>
</div><footer><div class="jsx-2519965637 block"><img src="http://greweb.me/logo.svg" width="100" class="jsx-2519965637"/><div class="jsx-2519965637 right"><div class="jsx-2519965637 description">generative artist. doodling with algorithms (creative coding). shaders &amp; fountain pens robot plotting.</div><div class="jsx-2519965637 social"><a href="https://twitter.com/greweb" class="jsx-2519965637"><img alt="" src="/icons/twitter.svg" class="jsx-2519965637"/></a><a href="https://instagram.com/greweb" class="jsx-2519965637"><img alt="" src="/icons/instagram.svg" class="jsx-2519965637"/></a><a href="https://twitch.tv/greweb" class="jsx-2519965637"><img alt="" src="/icons/twitch.svg" class="jsx-2519965637"/></a><a href="https://github.com/gre" class="jsx-2519965637"><img alt="" src="/icons/github.svg" class="jsx-2519965637"/></a><a href="https://opensea.io/greweb" class="jsx-2519965637"><img alt="" src="/icons/eth.svg" class="jsx-2519965637"/></a><a href="https://objkt.com/profile/tz1cgQAQfECg5bPASYTMyJ9QJQjSUi8rfL67" class="jsx-2519965637"><img alt="" src="/icons/tz.svg" class="jsx-2519965637"/></a><a href="https://fxhash.xyz/u/greweb" class="jsx-2519965637"><img alt="" src="/icons/tz.svg" class="jsx-2519965637"/></a><a href="https://greweb.itch.io" class="jsx-2519965637"><img alt="" src="/icons/iconmonstr-gamepad-3.svg" class="jsx-2519965637"/></a></div></div></div></footer></article></div></div></div><script>hljs.highlightAll();</script></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"2016-12-03-gl-react-v3","year":"2016","month":"12","day":"03","slug":"gl-react-v3","content":"\u003ch1 id=\"happy-to-release-httpsgl-react-cookbooksurgesh-containing-43-unique-examples-and-api-documentation\"\u003eHappy to release \u003cstrong\u003e\u003ca href=\"https://gl-react-cookbook.surge.sh\"\u003ehttps://gl-react-cookbook.surge.sh\u003c/a\u003e\u003c/strong\u003e containing 43 unique examples and API documentation!\u003c/h1\u003e\n\u003cp\u003e\u003ca href=\"https://gl-react-cookbook.surge.sh\"\u003e\u003cimg src=\"/images/2016/12/gl-react-v3.gif\" alt=\"\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIf you don\u0026#39;t want to be \u0026quot;spoiled\u0026quot; by this article, go through \u003ca href=\"https://gl-react-cookbook.surge.sh\"\u003ethe cookbook examples\u003c/a\u003e. This article will explore some of them.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c!--more--\u003e\n\n\u003ch2 id=\"gl-react-has-been-rewritten-from-scratch\"\u003egl-react has been rewritten from scratch\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003egl-react v3 is a complete rewrite of the v2 implementation for better performance and compatibility with React paradigm.\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eThis is not yet published on NPM as it\u0026#39;s \u003ca href=\"https://github.com/gre/gl-react\"\u003estill in development\u003c/a\u003e (the Web version is pretty ready, React Native version is not implemented).\u003c/p\u003e\n\u003cp\u003eMost features provided by gl-react v2 are preserved (API haven\u0026#39;t changed, \u003ca href=\"https://gl-react-cookbook.surge.sh/hellogl\"\u003esee how similar is the HelloGL example\u003c/a\u003e), but v3 fixes most Github issues accumulated for a year.\u003c/p\u003e\n\u003ch3 id=\"the-biggest-mistake-of-the-previous-implementation\"\u003eThe biggest mistake of the previous implementation\u003c/h3\u003e\n\u003cp\u003eIf there is one lesson learned from previous gl-react implementation: \u003cstrong\u003e\u0026quot;unfolding\u0026quot; / consuming the \u003ccode\u003echildren\u003c/code\u003e prop by yourself is (probably) wrong, let React solve this job!\u003c/strong\u003e Using React, you can benefit \u003ca href=\"https://facebook.github.io/react/docs/reconciliation.html\"\u003eReact reconciliation and diff algorithm\u003c/a\u003e.\nIn other words, always prefer to keep users\u0026#39; VDOM tree rather than consuming it with \u003ccode\u003eReact.Children.*\u003c/code\u003e functions.\u003c/p\u003e\n\u003cp\u003eI feel dumb not having discovered this before, but if you are not actually rendering DOM it\u0026#39;s an easy path for a library to just map, traverse, consume the children tree and just render what you needs (like just a \u003ccode\u003e\u0026lt;canvas/\u0026gt;\u003c/code\u003e). But this is probably a mistake! First, this makes it impossible to use React Devtools and see the original tree, but more importantly, it breaks interoperability with other libraries (e.g. don\u0026#39;t forbid someone to use \u003ca href=\"https://github.com/chenglou/react-motion\"\u003ereact-motion\u003c/a\u003e or \u003ca href=\"https://github.com/ReactTraining/react-router\"\u003eReact Router\u003c/a\u003e in the middle of your components!).\u003c/p\u003e\n\u003cp\u003eA better idea is to preserve the user \u003ccode\u003echildren\u003c/code\u003e. Keep your logic in each Component and use the React lifecycle to create and destroy things, and \u003cstrong\u003euse \u003ca href=\"https://facebook.github.io/react/docs/context.html\"\u003eReact context\u003c/a\u003e to connect children to parent\u003c/strong\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eYou should better keep user \u003ccode\u003echildren\u003c/code\u003e, even if it means rendering it in an empty \u003ccode\u003e\u0026lt;span\u0026gt;\u003c/code\u003e, \u003cem\u003ecurrent workaround of \u003ccode\u003egl-react\u003c/code\u003e, looking forward to hearing from you, idea inspired from the great \u003ca href=\"https://github.com/FormidableLabs/react-music\"\u003ereact-music\u003c/a\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"what-it-means-for-gl-react\"\u003eWhat it means for gl-react\u003c/h3\u003e\n\u003cp\u003eThe gl-react v3 implementation truly uses React lifecycle: \u003cstrong\u003ea React Component update triggers a GL redraw\u003c/strong\u003e. That way, \u003ccode\u003eshouldComponentUpdate\u003c/code\u003e allows to do partial GL re-rendering. Each Node holds a \u003ca href=\"https://www.opengl.org/wiki/Framebuffer_Object\"\u003eframebuffer object\u003c/a\u003e (created on mount, destroyed on unmount) that only get redrawn when component updates and schedules a Surface reflow.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\u0026lt;Node\u0026gt;\u003c/code\u003e receives the \u003ccode\u003egl: WebGLRenderingContext\u003c/code\u003e from the ancestor \u003ccode\u003e\u0026lt;Surface\u0026gt;\u003c/code\u003e thanks to \u003ca href=\"https://facebook.github.io/react/docs/context.html\"\u003eReact context\u003c/a\u003e. There is also a \u003ccode\u003eglParent\u003c/code\u003e context (a Surface or another Node) that is used to make GL components discoverable each other so we can build a dependency graph. This dependency graph allows to implement the correct \u003ccode\u003edraw\u003c/code\u003e pipeline (and it\u0026#39;s pretty trivial, see \u003ca href=\"#under_the_hook_redraw\"\u003e\u003cem\u003eSection \u0026quot;under the hood of Surface and Node redraw\u0026quot;\u003c/em\u003e\u003c/a\u003e).\u003c/p\u003e\n\u003ch2 id=\"bus-a-better-way-to-share-computation\"\u003e\u003ccode\u003e\u0026lt;Bus\u0026gt;\u003c/code\u003e, a better way to share computation\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"http://greweb.me/2016/06/glreactconf/\"\u003egl-react used to automatically factorize the duplicates elements of the GL tree\u003c/a\u003e but \u003cstrong\u003eit has been decided to remove this feature\u003c/strong\u003e: \u003cem\u003eThis was actually a complex mechanism (a bit too \u0026quot;magic\u0026quot;), hard to implement and a premature optimization that can have slower performance.\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eThe new gl-react embraces the React paradigm: The new way to express a Graph (and share computation) is \u003cstrong\u003eusing a \u003ca href=\"https://gl-react-cookbook.surge.sh/api#bus\"\u003e\u003ccode\u003e\u0026lt;Bus\u0026gt;\u003c/code\u003e\u003c/a\u003e\u003c/strong\u003e...\u003c/p\u003e\n\u003ch3 id=\"the-ref-pattern\"\u003eThe \u003ccode\u003e`()=\u0026gt;ref`\u003c/code\u003e pattern\u003c/h3\u003e\n\u003cp\u003eThe problem we want to solve is to \u003cstrong\u003eexpress a graph with React\u003c/strong\u003e, which, at first glance, only allow to represent trees, not graphs!\u003c/p\u003e\n\u003cp\u003eThe way we can solve this is by using refs and a \u0026quot;ref getter function\u0026quot;:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003ea Bus with a ref:\u003c/strong\u003e \u003ccode\u003e\u0026lt;Bus ref=\u0026quot;myBus\u0026quot;\u0026gt;{content to inject}\u0026lt;/Bus\u0026gt;\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003epass a function that resolves the ref\u003c/strong\u003e to pipe Bus into another Node. e.g: \u003ccode\u003e()=\u0026gt;this.refs.myBus\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca href=\"https://gl-react-cookbook.surge.sh/blurmapdyn\"\u003eblurmapdyn example \u003cimg src=\"/images/2016/12/blurmapdyn.gif\" alt=\"\"\u003e\u003c/a\u003e\na single ConicalGradient should be used for all blur pass:\n\u003cimg src=\"/images/2016/12/blurmapdynschema.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eThere are a few other good examples of ref usages:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://gl-react-cookbook.surge.sh/blurmapmouse\"\u003eblurmapmouse\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://gl-react-cookbook.surge.sh/blurimgtitle\"\u003eblurimgtitle\u003c/a\u003e (same example that was features in 2016 React conf!)\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://gl-react-cookbook.surge.sh/behindasteroids\"\u003ebehindasteroids\u003c/a\u003e, crazy port of a game I made for js13k.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe \u003ccode\u003e()=\u0026gt;ref\u003c/code\u003e pattern works only if you call the function after component did update (refs are set at this time).\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"the-good-ol-children-function\"\u003eThe good ol\u0026#39; children function\u003c/h2\u003e\n\u003cp\u003eThere is another pattern for more specific needs: instead of composing by giving an element, you can also compose by giving a \u003cstrong\u003eFunction that returns an element\u003c/strong\u003e. Why that? Because, it\u0026#39;s a way to nicely give you the redraw function: \u003ccode\u003eredraw =\u0026gt; \u0026lt;Video onFrame={redraw} /\u0026gt;\u003c/code\u003e:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gl-react-cookbook.surge.sh/video?menu=true\"\u003eCheckout video example \u003cimg src=\"/images/2016/12/videoredraw.png\" alt=\"\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWe really just want to redraw if there is a new video frame.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eWe have merged the 2 patterns into one: if you provide a function, it\u0026#39;s just called with \u003ccode\u003eredraw\u003c/code\u003e, and the returned value is used as a texture. We have a few cases to detect what kind of texture it is (and also an \u003ca href=\"https://gl-react-cookbook.surge.sh/api#textureloaders\"\u003eextensible mechanism\u003c/a\u003e used by implementations to load platform specific objects).\n\u003ca href=\"https://github.com/gre/gl-react/blob/a33e6aa685479d588646b20dd62e1e25a64a5a47/packages/gl-react/src/Node.js#L704-L783\"\u003e(checkout this if you want to see the code)\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"node-backbuffering--backbuffer-symbol\"\u003eNode backbuffering \u0026amp; Backbuffer symbol\u003c/h2\u003e\n\u003cp\u003eA new feature allows to inject the previous Node state as a texture. This is called backbuffering. One simple usecase is to implement Motion Blur persistence (like the GIF on top of this article).\u003c/p\u003e\n\u003cp\u003eWe can also accumulate a state, for instance, to implement Game of Life!\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gl-react-cookbook.surge.sh/golglider\"\u003eGame of life glider example \u003cimg src=\"/images/2016/12/gol.gif\" alt=\"\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eAnd the whole idea of gl-react (and React) is about composition. For instance, doing a rotating effect of that Game of Life is basically just \u003ccode\u003e\u0026lt;Rotate\u0026gt; \u0026lt;GameOfLife /\u0026gt; \u0026lt;/Rotate\u0026gt;\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eAn interesting part is that you can update the GameOfLife at a rate that is independent from the \u003cstrong\u003eRotate\u003c/strong\u003e rendering: just by making GameOfLife a pure component that receives a tick, or implementing shouldComponentUpdate update (you have as many choices as React have to \u003ca href=\"https://facebook.github.io/react/docs/react-api.html#react.purecomponent\"\u003eshortcut the rendering\u003c/a\u003e).\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://gl-react-cookbook.surge.sh/golrotscu\"\u003egolrotscu example\u003cimg src=\"/images/2016/12/golrot.gif\" alt=\"\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSee the counters that indicate the number of redraw. (the capture preview in the Box only get snapshot each 100ms, but in the real canvas, it runs at 60 FPS)\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eFinally, please checkout \u003ca href=\"https://gl-react-cookbook.surge.sh/ibex\"\u003eibex example\u003c/a\u003e (extracted from another JS13K game! xD).\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eYou can\u0026#39;t leave this article before seeing \u003ca href=\"https://gl-react-cookbook.surge.sh/ibex\"\u003eibex example\u003c/a\u003e! I\u0026#39;m serious, this is probably the most accomplished code I ever wrote! xD\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"-under-the-hood-of-surface-and-node-redraw\"\u003e\u003ca name=\"under_the_hook_redraw\"\u003e\u003c/a\u003e under the hood of Surface and Node redraw\u003c/h2\u003e\n\u003cp\u003eIn order to make redraw efficient, \u003ccode\u003egl-react\u003c/code\u003e have 2 phases: the \u003ccode\u003eredraw()\u003c/code\u003e phase and the \u003ccode\u003eflush()\u003c/code\u003e phase (reflecting the respective methods available both on \u003ccode\u003eSurface\u003c/code\u003e and \u003ccode\u003eNode\u003c/code\u003e). This is a bit like a rendering engine:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eredraw()\u003c/code\u003e phase\u003c/strong\u003e sets a dirty flag to a Node and all its \u0026quot;dependents\u0026quot; (other nodes, buses, surface). \u003cem\u003eredraws happen generally bottom-up to the Surface.\u003c/em\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eflush()\u003c/code\u003e phase\u003c/strong\u003e draws all nodes that have the redraw flag. \u003cem\u003edraws happens top-down from the Surface.\u003c/em\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003eredraw()\u003c/code\u003e is directly hooked to React update lifecycle (re-rendering a Node will calls \u003ccode\u003eredraw()\u003c/code\u003e for you).\nTo make this system efficient, \u003cstrong\u003ethe flush() is by default asynchronous\u003c/strong\u003e, i.e. \u003ccode\u003eredraw()\u003c/code\u003e means scheduling a new gl draw.\nSurface have a main loop that runs at 60 fps and call \u003ccode\u003eflush()\u003c/code\u003e. This is very efficient because if Surface does not have the redraw flag, \u003ccode\u003eflush()\u003c/code\u003e does nothing.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIn gl-react inspector, clicking on the redraw count will call \u003ccode\u003eredraw()\u003c/code\u003e on the node / bus. We can illustrate that only \u0026quot;dependents\u0026quot; get redrawn using the advanced \u003ca href=\"https://gl-react-cookbook.surge.sh/blurimgtitle\"\u003eblurimgtitle example\u003c/a\u003e:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003ca href=\"https://gl-react-cookbook.surge.sh/blurimgtitle\"\u003eonly \u0026quot;dependents\u0026quot; get redrawn \u003cimg src=\"/images/2016/12/blurimgtitle-redraw.gif\" alt=\"\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThis redraw/flush phases allow to prevent and skip rendering multiple times a Node. In some cases, we still want to redraw synchronously: with \u003ccode\u003e\u0026lt;Node/\u0026gt;\u003c/code\u003e \u003ccode\u003esync\u003c/code\u003e prop. For instance, in Game of Life, we don\u0026#39;t want to skip an update (the initial update set the initial GoL state, if it was async it might get skipped).\u003c/p\u003e\n\u003ch2 id=\"bonus\"\u003eBonus\u003c/h2\u003e\n\u003ch3 id=\"flow-types\"\u003eFlow types\u003c/h3\u003e\n\u003cp\u003eFlow types has been used for more robust code and better user experience. BTW, \u003ca href=\"https://github.com/facebook/flow/pull/2764\"\u003eWebGLRenderingContext will soon be released in flow\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"atom-highlighting\"\u003eAtom highlighting\u003c/h3\u003e\n\u003cp\u003eIf you are using Atom Editor, you can have JS inlined GLSL syntax highlighted.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://cloud.githubusercontent.com/assets/211411/20623048/0527cce2-b306-11e6-85ee-5020be994c10.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eTo configure this:\u003c/em\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eadd \u003ccode\u003elanguage-babel\u003c/code\u003e package.\u003c/li\u003e\n\u003cli\u003eConfigure \u003ccode\u003elanguage-babel\u003c/code\u003e to add \u003ccode\u003eGLSL:source.glsl\u003c/code\u003e in settings \u0026quot;\u003cem\u003eJavaScript Tagged Template Literal Grammar Extensions\u003c/em\u003e\u0026quot;.\u003c/li\u003e\n\u003cli\u003e(Bonus) Add this CSS to your \u003cem\u003eAtom \u0026gt; Stylesheet\u003c/em\u003e:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"language-css\"\u003e/* language-babel blocks */\natom-text-editor::shadow .line .ttl-grammar {\n  /* NB: designed for dark theme. can be customized */\n  background-color: rgba(0, 0, 0, 0.3);\n}\natom-text-editor::shadow .line .ttl-grammar:first-child:last-child {\n  display: block; /* force background to take full width only if ttl-grammar is alone in the line. */\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"tests-almost-100-coverage\"\u003eTests: almost 100% coverage!\u003c/h3\u003e\n\u003cp\u003eThe library is tested directly on the command line, thanks to \u003ca href=\"https://github.com/facebook/jest\"\u003eJest\u003c/a\u003e and \u003ca href=\"https://github.com/stackgl/headless-gl\"\u003eheadless-gl\u003c/a\u003e \u003cem\u003e(Big up to \u003ca href=\"https://github.com/mikolalysenko\"\u003emikolalysenko\u003c/a\u003e for \u003ca href=\"https://github.com/stackgl/headless-gl\"\u003eheadless-gl\u003c/a\u003e!)\u003c/em\u003e.\n\u003cstrong\u003egl-react have 2000 line of tests, involving a lot of gl calls, and readPixels, and it runs... in a few seconds!\u003c/strong\u003e \u003cem\u003e(to Jest devs: you are wizards!)\u003c/em\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\n PASS  ./all.test.js\n  â renders a red shader (75ms)\n  â renders HelloGL (15ms)\n  â ndarray texture (27ms)\n  â renders a color uniform (18ms)\n  â composes color uniform with LinearCopy (21ms)\n  â no needs to flush if use of sync (24ms)\n  â Node can have a different size and be scaled up (18ms)\n  â Surface can be resized (32ms)\n  â bus uniform code style (17ms)\n  â bus example 1 (17ms)\n  â bus example 2 (18ms)\n  â bus example 3 (17ms)\n  â bus example 4 (22ms)\n  â bus example 5 (14ms)\n  â bus example 6 (24ms)\n  â bus: same texture used in multiple sampler2D is fine (14ms)\n  â a surface can be captured and resized (16ms)\n  â a node can be captured and resized (17ms)\n  â Uniform children redraw=\u0026gt;el function (22ms)\n  â Bus redraw=\u0026gt;el function (16ms)\n  â many Surface updates don\u0026#39;t result of many redraws (18ms)\n  â many Surface flush() don\u0026#39;t result of extra redraws (10ms)\n  â GL Components that implement shouldComponentUpdate shortcut Surface redraws (27ms)\n  â nested GL Component update will re-draw the Surface (24ms)\n  â Node `clear` and discard; (24ms)\n  â Node `backbuffering` (32ms)\n  â Node `backbuffering` in `sync` (36ms)\n  â texture can be null (12ms)\n  â array of textures (22ms)\n  â Node uniformsOptions texture interpolation (17ms)\n  â can be extended with addTextureLoaderClass (70ms)\n  â Surface `preload` prevent to draw anything (59ms)\n  â Surface `preload` that fails will trigger onLoadError (59ms)\n  â renders a shader inline in the Node (15ms)\n  â testing connectSize() feature (17ms)\n  â handle context lost nicely (43ms)\n  â Bus#uniform and Bus#index (25ms)\n  â VisitorLogger + bunch of funky extreme tests (140ms)\n\n-------------------------------|----------|----------|----------|----------|----------------|\nFile                           |  % Stmts | % Branch |  % Funcs |  % Lines |Uncovered Lines |\n-------------------------------|----------|----------|----------|----------|----------------|\nAll files                      |    97.85 |     88.8 |    95.96 |    99.35 |                |\n src                           |    97.82 |    88.95 |     95.9 |    99.35 |                |\n  Backbuffer.js                |      100 |      100 |      100 |      100 |                |\n  Bus.js                       |    96.15 |    74.29 |      100 |      100 |                |\n  GLSL.js                      |      100 |       50 |      100 |      100 |                |\n  LinearCopy.js                |      100 |      100 |      100 |      100 |                |\n  NearestCopy.js               |      100 |      100 |      100 |      100 |                |\n  Node.js                      |    97.65 |    92.71 |    97.01 |    99.01 |    214,216,358 |\n  Shaders.js                   |      100 |    76.92 |      100 |      100 |                |\n  Texture2DLoader.js           |      100 |      100 |      100 |      100 |                |\n  TextureLoader.js             |      100 |      100 |      100 |      100 |                |\n  TextureLoaderNDArray.js      |      100 |      100 |      100 |      100 |                |\n  TextureLoaders.js            |      100 |      100 |      100 |      100 |                |\n  Visitor.js                   |      100 |      100 |       75 |      100 |                |\n  VisitorLogger.js             |      100 |    92.59 |      100 |      100 |                |\n  Visitors.js                  |      100 |      100 |      100 |      100 |                |\n  connectSize.js               |      100 |    85.71 |      100 |      100 |                |\n  copyShader.js                |      100 |      100 |      100 |      100 |                |\n  createSurface.js             |    97.09 |    83.61 |    94.55 |    99.32 |            361 |\n  genId.js                     |      100 |      100 |      100 |      100 |                |\n  index.js                     |      100 |      100 |      100 |      100 |                |\n src/helpers                   |      100 |       75 |      100 |      100 |                |\n  disposable.js                |      100 |       50 |      100 |      100 |                |\n  invariantNoDependentsLoop.js |      100 |      100 |      100 |      100 |                |\n-------------------------------|----------|----------|----------|----------|----------------|\nTest Suites: 1 passed, 1 total\nTests:       38 passed, 38 total\nSnapshots:   4 passed, 4 total\nTime:        2.655s\nRan all test suites.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOne limitation is that all tests need to be in a single file. \u003ca href=\"https://github.com/facebook/jest/issues/2029\"\u003eI created an issue here\u003c/a\u003e. I think it\u0026#39;s either an issue in \u003ca href=\"https://github.com/facebook/jest\"\u003eJest\u003c/a\u003e or in \u003ca href=\"https://github.com/stackgl/headless-gl\"\u003eheadless-gl\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"tradeoffs-and-remaining-work\"\u003eTradeoffs and remaining work\u003c/h2\u003e\n\u003cp\u003eThe library tradeoffs are written in \u003ca href=\"https://github.com/gre/gl-react/blob/master/TRADEOFFS.md\"\u003eTRADEOFFS.md\u003c/a\u003e. We might cover some unexplored direction in a near future and solve some of them.\u003c/p\u003e\n\u003cp\u003ev3 is still in development, the main unfinished part is the React Native implementation which is now the main priority of the library.\nIt will probably rely on an awesome initiative: a React Native WebGL implementation started in Exponent by \u003ca href=\"https://github.com/nikki93\"\u003e@nikki\u003c/a\u003e!\u003c/p\u003e\n\u003cp\u003eFor more information, see \u003ca href=\"https://github.com/gre/gl-react#v3-alpha-development-in-progress\"\u003ev3 alpha: development in progress\u003c/a\u003e.\u003c/p\u003e\n","data":{"title":"gl-react v3","thumbnail":"/images/2016/12/thumbnail.png","description":"gl-react has been reimplemented from scratch, feedback from previous mistake and overview of new features.","author":"Gaetan","layout":"post","tags":["react","gl-react","webgl"]}},"__N_SSG":true},"page":"/[year]/[month]/[slug]","query":{"year":"2016","month":"12","slug":"gl-react-v3"},"buildId":"Zokw2miiDZwMJvb6cOfQx","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>